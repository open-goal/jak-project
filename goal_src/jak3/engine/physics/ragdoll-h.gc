;;-*-Lisp-*-
(in-package goal)

;; name: ragdoll-h.gc
;; name in dgo: ragdoll-h
;; dgos: GAME

;; DECOMP BEGINS

(deftype ragdoll-edit-info (structure)
  ((editing          symbol)
   (current-func     uint64)
   (analog-func      uint64)
   (affect           uint64)
   (single-step      uint64)
   (collision        symbol)
   (gravity          symbol)
   (skel-visible     uint64)
   (current-joint    int8)
   (auto-setup-now   basic)
   (child-stack      object  60)
   (child-stack-num  int8)
   (last-frame       uint64)
   (last-frame-dur   uint64)
   )
  (:methods
    (ragdoll-edit-info-method-9 () none)
    (ragdoll-edit-info-method-10 () none)
    (ragdoll-edit-info-method-11 () none)
    (ragdoll-edit-info-method-12 () none)
    (ragdoll-edit-info-method-13 () none)
    (ragdoll-edit-info-method-14 () none)
    (ragdoll-edit-info-method-15 () none)
    (ragdoll-edit-info-method-16 () none)
    (ragdoll-edit-info-method-17 () none)
    )
  )


(define *ragdoll-edit-info* (the-as ragdoll-edit-info 0))

(define *ragdoll-edit-info* (new 'static 'ragdoll-edit-info
                              :editing #t
                              :current-func #x9
                              :single-step #x2
                              :collision #t
                              :gravity #t
                              :skel-visible #x1
                              )
        )

(deftype ragdoll-joint-setup (structure)
  ((joint-index   int32)
   (parent-joint  int32)
   (joint-type    uint64)
   (pre-tform     vector  :inline)
   (geo-tform     vector  :inline)
   (axial-slop    float)
   (max-angle     float)
   (coll-rad      float)
   (hit-sound     uint128)
   )
  )


(deftype ragdoll-setup (structure)
  ((orient-tform     vector  :inline)
   (scale            vector  :inline)
   (bg-collide-with  collide-spec)
   (joint-setup      basic)
   )
  )


(deftype ragdoll-joint (structure)
  ((quat                 quaternion  :inline)
   (position             vector      :inline)
   (velocity             vector      :inline)
   (bounce               vector      :inline)
   (old-x                vector      :inline)
   (pre-tform            vector      :inline)
   (geo-tform            vector      :inline)
   (axial-slop           float)
   (max-angle            float)
   (joint-length         float)
   (coll-rad             float)
   (ragdoll-joint-flags  uint32)
   (joint-type           uint64)
   (joint-index          int8)
   (parent-joint         int8)
   (parent-index         int8)
   (num-children         int8)
   (old-param0           basic)
   (hit-sound            uint128)
   (ground-pat           uint32)
   (user0                int32)
   (original-speed       float)
   )
  )


(deftype ragdoll (basic)
  ((ragdoll-joints         ragdoll-joint  60 :inline)
   (num-joints             uint8)
   (mirror                 matrix         :inline)
   (gravity                vector         :inline)
   (gravity-target         vector         :inline)
   (orient-tform           vector         :inline)
   (scale                  vector         :inline)
   (stretch-vel            float)
   (stretch-vel-parallel   float)
   (compress-vel           float)
   (compress-vel-parallel  float)
   (momentum               float)
   (maximum-stretch        float)
   (turn-off-start         uint64)
   (turn-off-duration      uint64)
   (copy-velocity-start    uint64)
   (root-offset            vector         :inline)
   (rotate-vel             quaternion     :inline)
   (rotate-adj             quaternion     :inline)
   (rotate-adj-count       int8)
   (ragdoll-flags          uint32)
   (flex-blend             float)
   (stable-joints          int8)
   (ragdoll-joint-remap    uint8          100)
   (allow-destabilize      uint64)
   (bg-collide-with        uint32)
   (water-info             water-info     :inline)
   )
  (:methods
    (ragdoll-method-9 () none)
    (ragdoll-method-10 () none)
    (ragdoll-method-11 () none)
    (ragdoll-method-12 () none)
    (ragdoll-method-13 () none)
    (ragdoll-method-14 () none)
    (ragdoll-method-15 () none)
    (ragdoll-method-16 () none)
    (ragdoll-method-17 () none)
    (ragdoll-method-18 () none)
    (ragdoll-method-19 () none)
    (ragdoll-method-20 () none)
    (ragdoll-method-21 () none)
    (ragdoll-method-22 () none)
    (ragdoll-method-23 () none)
    (ragdoll-method-24 () none)
    (ragdoll-method-25 () none)
    )
  )


(deftype ragdoll-proc (process)
  ((ragdoll         ragdoll)
   (last-attack-id  uint32)
   )
  (:methods
    (ragdoll-proc-method-14 () none)
    (ragdoll-proc-method-15 () none)
    (ragdoll-proc-method-16 () none)
    (ragdoll-proc-method-17 () none)
    (ragdoll-proc-method-18 () none)
    (ragdoll-proc-method-19 () none)
    )
  )


(deftype wings-ragdoll-proc (ragdoll-proc)
  ()
  )
