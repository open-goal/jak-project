;;-*-Lisp-*-
(in-package goal)

;; name: collectables.gc
;; name in dgo: collectables
;; dgos: GAME, ENGINE

;; TODO - for nav-enemy
(define-extern birth-pickup-at-point (function vector int float symbol process-drawable symbol none)) ;; TODO - unconfirmed - see beach-rocks
;; TODO - for oracle
(define-extern *fuel-cell-sg* skeleton-group) ;; unknown type
;; TODO - for entity and beach-rocks
(deftype collectable (process-drawable)
  ((pickup-type     int32          :offset-assert 176)
   (pickup-amount   float          :offset-assert 180)
   (notify-parent   basic          :offset-assert 184)
   (old-base        vector :inline :offset-assert 192)
   (base            vector :inline :offset-assert 208)
   (extra-trans     vector :inline :offset-assert 224)
   (jump-pos        vector :inline :offset-assert 240)
   (flags           uint32         :offset-assert 256)
   (birth-time      uint64         :offset-assert 264)
   (collect-timeout uint64         :offset-assert 272)
   (fadeout-timeout uint64         :offset-assert 280)
   (bob-offset      uint64         :offset-assert 288)
   (bob-amount      float          :offset-assert 296)
   (pickup-handle   handle         :offset-assert 304) ;; not sure it's a handle
   (actor-pause     basic          :offset-assert 312)
   )

  (:methods
    (dummy-20 () none 20)
    (dummy-21 () none 21)
    )
  :heap-base #xd0

  :method-count-assert 22
  :size-assert         #x13c
  :flag-assert         #x1600d0013c
  )

(deftype eco-collectable (collectable)
  ((eco-effect          basic          :offset-assert 316)
   (collect-effect      basic          :offset-assert 320)
   (collect-effect2     basic          :offset-assert 324)
   (collect-effect-time uint64         :offset-assert 328)
   (respawn-delay       uint64         :offset-assert 336)
   (sound-name          basic          :offset-assert 344)
   (target              uint64         :offset-assert 352)
   (suck-time           uint64         :offset-assert 360)
   (suck-y-offset       float          :offset-assert 368)
   (speed               vector :inline :offset-assert 384)
   (movie-pos-index     int32          :offset-assert 400)
   )
  (:methods
    (wait () none 22) ;; state
    (pickup () none 23) ;; state
    (die () none 24) ;; state
    (dummy-25 () none 25)
    (notice-blue () none 26) ;; state
    (dummy-27 () none 27)
    (dummy-28 () none 28)
    (dummy-29 () none 29)
    (dummy-30 () none 30)
    )

  :heap-base #x130
  :method-count-assert 31
  :size-assert         #x194
  :flag-assert         #x1f01300194
  )

(deftype fuel-cell (eco-collectable)
  ((victory-anim basic :offset-assert 404)
   (state-object basic :offset-assert 408))
  :heap-base #x130
  :method-count-assert 31
  :size-assert         #x19c
  :flag-assert         #x1f0130019c
  )
(define-extern fuel-cell-init-as-clone (function handle object none))
