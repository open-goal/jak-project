;;-*-Lisp-*-
(in-package goal)

;; LiveSplit ASL requires all settings to initalized _before_ you connect the process
;; Therefore everything has to be laid out in a predictable fashion before hand
;; So this is a lot of hard-coding, but not too bad when just copied from the debug menu code
;;
;; DO NOT change the order, appending to the end is safe!
(deftype autosplit-info-jak1 (structure)
  (;; General stats
   (num-power-cells uint32)
   (num-orbs uint32)
   (num-scout-flies uint32)
   ;; orbs per-level
   (training-num-orbs uint8)
   (village1-num-orbs uint8)
   (beach-num-orbs uint8)
   (jungle-num-orbs uint8)
   (misty-num-orbs uint8)
   (firecanyon-num-orbs uint8)
   (village2-num-orbs uint8)
   (sunken-num-orbs uint8)
   (swamp-num-orbs uint8)
   (rolling-num-orbs uint8)
   (ogre-num-orbs uint8)
   (village3-num-orbs uint8)
   (snow-num-orbs uint8)
   (cave-num-orbs uint8)
   (lavatube-num-orbs uint8)
   (citadel-num-orbs uint8)
   ;; scout flies per-level
   (training-num-scout-flies uint8)
   (village1-num-scout-flies uint8)
   (beach-num-scout-flies uint8)
   (jungle-num-scout-flies uint8)
   (misty-num-scout-flies uint8)
   (firecanyon-num-scout-flies uint8)
   (village2-num-scout-flies uint8)
   (sunken-num-scout-flies uint8)
   (swamp-num-scout-flies uint8)
   (rolling-num-scout-flies uint8)
   (ogre-num-scout-flies uint8)
   (village3-num-scout-flies uint8)
   (snow-num-scout-flies uint8)
   (cave-num-scout-flies uint8)
   (lavatube-num-scout-flies uint8)
   (citadel-num-scout-flies uint8)
   ;; Version Info (it's so far down because it was an after thought!)
   (version-major uint16)
   (version-minor uint16)
   (padding-stats uint8 164) ;; padding for future growth
   ;; loading/cutscene/control related info
   (game-hash uint32)
   (in-cutscene? symbol)
   (is-loading? symbol)
   (padding-controls uint8 200) ;; padding for future growth
   ;; need-resolution tasks
   (res-training-gimmie uint8)
   (res-training-door uint8)
   (res-training-climb uint8)
   (res-training-buzzer uint8)
   (res-jungle-eggtop uint8)
   (res-jungle-lurkerm uint8)
   (res-jungle-tower uint8)
   (res-jungle-fishgame uint8)
   (res-jungle-plant uint8)
   (res-jungle-buzzer uint8)
   (res-jungle-canyon-end uint8)
   (res-jungle-temple-door uint8)
   (res-village1-yakow uint8)
   (res-village1-mayor-money uint8)
   (res-village1-uncle-money uint8)
   (res-village1-oracle-money1 uint8)
   (res-village1-oracle-money2 uint8)
   (res-village1-buzzer uint8)
   (res-beach-ecorocks uint8)
   (res-beach-pelican uint8)
   (res-beach-flutflut uint8)
   (res-beach-seagull uint8)
   (res-beach-cannon uint8)
   (res-beach-buzzer uint8)
   (res-beach-gimmie uint8)
   (res-beach-sentinel uint8)
   (res-misty-muse uint8)
   (res-misty-boat uint8)
   (res-misty-warehouse uint8)
   (res-misty-cannon uint8)
   (res-misty-bike uint8)
   (res-misty-buzzer uint8)
   (res-misty-bike-jump uint8)
   (res-misty-eco-challenge uint8)
   (res-village2-gambler-money uint8)
   (res-village2-geologist-money uint8)
   (res-village2-warrior-money uint8)
   (res-village2-oracle-money1 uint8)
   (res-village2-oracle-money2 uint8)
   (res-village2-buzzer uint8)
   (res-swamp-billy uint8)
   (res-swamp-flutflut uint8)
   (res-swamp-battle uint8)
   (res-swamp-tether-1 uint8)
   (res-swamp-tether-2 uint8)
   (res-swamp-tether-3 uint8)
   (res-swamp-tether-4 uint8)
   (res-swamp-buzzer uint8)
   (res-swamp-arm uint8)
   (res-sunken-platforms uint8)
   (res-sunken-pipe uint8)
   (res-sunken-slide uint8)
   (res-sunken-room uint8)
   (res-sunken-sharks uint8)
   (res-sunken-buzzer uint8)
   (res-sunken-top-of-helix uint8)
   (res-sunken-spinning-room uint8)
   (res-rolling-race uint8)
   (res-rolling-robbers uint8)
   (res-rolling-moles uint8)
   (res-rolling-plants uint8)
   (res-rolling-lake uint8)
   (res-rolling-buzzer uint8)
   (res-rolling-ring-chase-1 uint8)
   (res-rolling-ring-chase-2 uint8)
   (res-snow-eggtop uint8)
   (res-snow-ram uint8)
   (res-snow-fort uint8)
   (res-snow-ball uint8)
   (res-snow-bunnies uint8)
   (res-snow-buzzer uint8)
   (res-snow-bumpers uint8)
   (res-snow-cage uint8)
   (res-red-eggtop uint8)
   (res-firecanyon-buzzer uint8)
   (res-firecanyon-end uint8)
   (res-citadel-sage-green uint8)
   (res-citadel-sage-blue uint8)
   (res-citadel-sage-red uint8)
   (res-citadel-sage-yellow uint8)
   (res-citadel-buzzer uint8)
   (res-village3-extra1 uint8)
   (res-village3-buzzer uint8)
   (res-village3-miner-money1 uint8)
   (res-village3-miner-money2 uint8)
   (res-village3-miner-money3 uint8)
   (res-village3-miner-money4 uint8)
   (res-village3-oracle-money1 uint8)
   (res-village3-oracle-money2 uint8)
   (res-cave-gnawers uint8)
   (res-cave-dark-crystals uint8)
   (res-cave-dark-climb uint8)
   (res-cave-robot-climb uint8)
   (res-cave-swing-poles uint8)
   (res-cave-spider-tunnel uint8)
   (res-cave-platforms uint8)
   (res-cave-buzzer uint8)
   (res-ogre-boss uint8)
   (res-ogre-end uint8)
   (res-ogre-buzzer uint8)
   (res-ogre-secret uint8)
   (res-lavatube-end uint8)
   (res-lavatube-buzzer uint8)
   (res-lavatube-balls uint8)
   (res-intro uint8)
   ;; misc other tasks
   (int-finalboss-movies uint8)
   (unk-finalboss-movies uint8)
   (int-jungle-fishgame uint8)
   ;; end marker just to make things look nice in a memory view
   (end-marker uint8 4)))

(define-extern *autosplit-info-jak1* autosplit-info-jak1)
(define-extern update-autosplit-info-jak1 (function none))
(define-extern update-autosplit-jak1-new-game (function none))
