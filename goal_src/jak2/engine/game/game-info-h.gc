;;-*-Lisp-*-
(in-package goal)

;; name: game-info-h.gc
;; name in dgo: game-info-h
;; dgos: ENGINE, GAME

(declare-type entity-perm-array inline-array-class)
(declare-type continue-point basic)
(declare-type game-save basic)





#|
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
YOU CAN READ THIS PART YOU WANT, YOU DONT HAVE TO :) These are ideas of mine to keep track of. Note that some are dated and this is more of a refernece for me..
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;



Upon loading for the first time in fortress, you will be given the option to choose one or to choose none.
then upon choosing, it saves a value attached to the option, a 1 or 0, to the save file directly
then an updating code block will check for a 1 or 0 and will actively set the corresponding mod a #t or symbol
It is required to choose one to gain access to the weapon mods menu. (IE if all 0, then the setting for gun mods in the secrets menu does not appear)

(define-extern traffic-nuke-option symbol) ;;this is define-externd for if its over all chosen
(define-extern traffic-nuke-save 0) ;;this is define-externd to set the gun for the option

jak does has a chance to cause 50 peacemaker shots to ring out in all directions.
But bosses must be one hit.

(define-extern trip-metalheads-option symbol)
(define-extern trip-metalheads-save 0)
Any input has a very small chance for Jak to get hurt with 0 damage,
but every time that happens you gain 50 metal head gems

(define-extern input-teleport-option symbol)
(define-extern input-teleport-save 0)
each time jak dies, it has a small chance to respawn jak to the final boss checkpoint.
but the final boss fight is extremely unfair.
the checkpoint is not stored or saved, nor is the save accessible during bossfight.
essentially you tp to boss, have a fun time in hell, die, then come back to your original checkpoint.

(define-extern ambush-tricks-option symbol)
(define-extern ambush-tricks-save 0)
any input rolls between 1-600. If it's 1, ambush jak.
you get the damage buff at this very moment
ambush: 6 cloaked metalheads spawn in a radius around jak. (it can be a static position honestly, makes it more hilarious)

(define-extern hell-mode-option symbol)
(define-extern hell-mode-save 0)
once a hero mode save is made, all options listed above are active at once in that save,
but you get legendary gun mods :) 





GUNMOD Shark (legendary)
Chance not to consume ammo

GUNMOD Mehrunes (legendary)
1/25 chance to instant kill

GUNMOD Random (legendary)
High chance to fire a random projectile alongside your gun

GUNMOD Explode (legendary)
All shots explode
------------------------------------------------------------------------------------------------------------------------------------------------------------------


CURRENT BUGS:
- GE PEACEMAKER_ABILITY: peacemaker weapon has to be available for peacemaker-ability to not crash the game upon trigger, so player starts with all weapons.
- GM PRED/GUARD SHOT: firing the guard or predator shot sets jak invulnerable for 3 frames until I can figure a way to not damage jak when firing
- GM PRED/GUARD SHOT: making jak invulnerable in this state turns off all the other game-secrets
- GM PREDATOR SHOT: firing the predator shot outside of ctywide and ctyport crashes the game
- GM BOARD PICKUP: the random gunmod trigger will happen upon drop, not upon pickup, but not for things like giving gems, that will be upon pickup >:[
  |#


#|;;;;;;;;;;;;;;;;;;;;;;;;;;
;      Var Definitions     ;
;;;;;;;;;;;;;;;;;;;;;;;;;;|#



















#|
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
YOU CAN READ THIS PART YOU WANT, YOU DONT HAVE TO :) These are ideas of mine to keep track of. Note that some are dated and this is more of a refernece for me..
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;



Upon loading for the first time in fortress, you will be given the option to choose one or to choose none.
then upon choosing, it saves a value attached to the option, a 1 or 0, to the save file directly
then an updating code block will check for a 1 or 0 and will actively set the corresponding mod a #t or #f
It is required to choose one to gain access to the weapon mods menu. (IE if all 0, then the setting for gun mods in the secrets menu does not appear)

(define traffic-nuke-option #f) ;;this is defined for if its over all chosen
(define traffic-nuke-save 0) ;;this is defined to set the gun for the option

jak does has a chance to cause 50 peacemaker shots to ring out in all directions.
But bosses must be one hit.

(define trip-metalheads-option #f)
(define trip-metalheads-save 0)
Any input has a very small chance for Jak to get hurt with 0 damage,
but every time that happens you gain 50 metal head gems

(define input-teleport-option #f)
(define input-teleport-save 0)
each time jak dies, it has a small chance to respawn jak to the final boss checkpoint.
but the final boss fight is extremely unfair.
the checkpoint is not stored or saved, nor is the save accessible during bossfight.
essentially you tp to boss, have a fun time in hell, die, then come back to your original checkpoint.

(define ambush-tricks-option #f)
(define ambush-tricks-save 0)
any input rolls between 1-600. If it's 1, ambush jak.
you get the damage buff at this very moment
ambush: 6 cloaked metalheads spawn in a radius around jak. (it can be a static position honestly, makes it more hilarious)

(define hell-mode-option #f)
(define hell-mode-save 0)
once a hero mode save is made, all options listed above are active at once in that save,
but you get legendary gun mods :) 





GUNMOD Shark (legendary)
Chance not to consume ammo

GUNMOD Mehrunes (legendary)
1/25 chance to instant kill

GUNMOD Random (legendary)
High chance to fire a random projectile alongside your gun

GUNMOD Explode (legendary)
All shots explode
------------------------------------------------------------------------------------------------------------------------------------------------------------------


CURRENT BUGS:
- GE PEACEMAKER_ABILITY: peacemaker weapon has to be available for peacemaker-ability to not crash the game upon trigger, so player starts with all weapons.
- GM PRED/GUARD SHOT: firing the guard or predator shot sets jak invulnerable for 3 frames until I can figure a way to not damage jak when firing
- GM PRED/GUARD SHOT: making jak invulnerable in this state turns off all the other game-secrets
- GM PREDATOR SHOT: firing the predator shot outside of ctywide and ctyport crashes the game
- GM BOARD PICKUP: the random gunmod trigger will happen upon drop, not upon pickup, but not for things like giving gems, that will be upon pickup >:[
  |#


#|;;;;;;;;;;;;;;;;;;;;;;;;;;
;      Var Definitions     ;
;;;;;;;;;;;;;;;;;;;;;;;;;;|#

;Modifier Definitions (gun-mod definitions in target-gun.gc)
(define tp-fb-win #f)
(define mod-reroll #f) ;toggle on to reroll your current mod for 10 metalhead gems
(define mod-rand 0)
(define mod-pick #f)

(define auto-save-delayed? #f)
(define auto-save-frame 0)

(define hell-mode-option #f) ;toggle on to set hell-mode on (just turn on hero-mode)

(define weapon-mod-toggle #f) ;The option thats asked at the beginning, toggling this on will choose a random modifier for jak.
(define wm-drop #f) ;Turns on weapon mods dropping off the next spawned enemy that can drop mods.
(define wm-leg #f) ;sees if a legendary has dropped, if toggled on, the game will never drop a legendary
(define wm-roll-rand #f)
(define wm-roll-numb 0)
(define wm-rand-shot #f) ;toggle on to enable random shot, a legendary gun mod
(define wm-roll-shot 0)
(define inv-frames? #f)



(define test-option #f) ;test projectile
(define mod-all-yellow #f) ;sets all gunmods to yellow gun
(define mod-all-blue #f) ;sets all gunmods to blue gun
(define mod-all-red #f) ;sets all gunmods to red gun
(define mod-all-dark #f) ;sets all gunmods to peacemaker
(define mod-all-off #t)
(define-extern mod-turning-off symbol)

(define peacemaker-ability #f)  ; Chance to encumber in peacemaker shots, bosses are 1 hit
(define pm-shot-counter 0)
(define-extern gun-dark-present? symbol)
(define pm-offset-y (new 'static 'vector :x (meters 0) :y (meters 2) :z (meters 0) :w 1.0))

(define tp-fb #f) ; toggle on for a chance to teleport for final boss upon death
(define start-tp #f)
(define new-game-s? #f)
(define frame-count 0)
(define start-frame-count #f)
(define going-back-tp #f)
(define stored-cp? #f)
(define pause-menu-blocked? #f)
(define-extern tp-fb-win symbol)

(define tp-fb-2 #f)
(define tp-framec 0)
(define start-tp-framec #f)

(define hover-damage #f) ;toggle on to enable hoverboard mechanics, but enemies have X5 HP

(define dark-traffic #f) ;toggle on for a chance to get darkjak meter to full off any dark eco, but traffic-alert-4 is set for any illegal activity

(define trip-metalheads #f) ;toggle on for a chance to trip, but jak will get 10 metalhead gems every time (on cooldown 4000 frames)
(define trip-start #f)
(define trip-cooldown 0)

(define target-explode #f) ;toggle on for jak to explode upon taking damage, but dark-jak lasts much longer.
(define target-explode-start #f)
(define explode-frames 0)
(define explode-frame-start #f)
(define dark-jacked? #f)
(define dark-jacked! #f)

(define dt-frame-start #f)
(define dt-count 0)
(define dt-control #f)

(define leg-got? #f)
(define-extern leg-random-int int)
(define leg-random-shot #f)
(define leg-dont-fire? #f)

(define mod-default-gun 1)

(define all-modifiers-off? #f)
(define mission-grab-1 #f) ;sets mission get for weapon mods
(define mission-grab-2 #f) ;sets mission get for weapon mods
(define mission-grab-3 #f) ;sets mission get for weapon mods
(define mission-grab-4 #f) ;sets mission get for weapon mods

(define mushroom-movies #t)
(define movie-int 0)
(define mushroom-movies-start #f)
(define mushroom-var 0)

;cty-guard-turret spawn params
(define spawned-turret-hideout? #f)
(define spawned-turrets-port? #f)
(define spawned-turrets-pal? #f)
(define spawned-turret-vin? #f)
(define spawned-turret-market? #f)

;menu vars
(define in-menu #f)
(define menu-slot 0)
(define menu-pressed? #f)
(define sub-menu-slot 0)
(define menu-activate #f)
(define weapon-id 0)
(define wait-frame 0)
(define wait-start #f)
(define wait-frame2 0)
(define wait-frame-start2 #f)
(define camera-locked #f)













(print "Runs at game start")












(defenum pickup-type
  :bitfield #f
  :type int32
  (none            0)
  (eco-yellow      1)
  (eco-red         2)
  (eco-blue        3)
  (eco-dark        4)
  (eco-green       5)
  (eco-pill-green  6)
  (eco-pill-dark   7)
  (eco-pill-random 8)
  (money           9)
  (fuel-cell      10)
  (buzzer         11)
  (darkjak        12)
  (ammo-yellow    13)
  (ammo-red       14)
  (ammo-blue      15)
  (ammo-dark      16)
  (shield         17)
  (health         18)
  (trick-point    19)
  (trick-judge    20)
  (gem            21)
  (skill          22)
  (karma          23)
  (gun-red        24)
  (gun-yellow     25)
  (gun-blue       26)
  (gun-dark       27)
  (board          28)
  (pass-red       29)
  (pass-green     30)
  (pass-yellow    31)
  (pass-blue      32)
  (ammo-random    33)
  )

(defenum continue-flags
  :type uint32
  :bitfield #t
  ;(continue-flag-0 0)
  (scene-wait 1)
  (change-continue 2)
  (no-auto 3)
  (no-blackout 4)
  (game-start 5)
  (demo-end 6)
  (warp-gate 7)
  (demo 8)
  (intro 9)
  (hero-mode 10)
  (demo-movie 11)
  (title 12)
  (title-movie 13)
  (continue-flag-14 14)
  (continue-flag-15 15)
  (continue-flag-16 16)
  (test 17)
  (record-path 18)
  (pilot 19)
  (pilot-dax 20)
  (record-sig 21)
  (indax 22)
  )

;; +++game-secrets
(defenum game-secrets
  :type uint32
  :bitfield #t
  (toggle-beard)
  (hflip-screen)
  (endless-ammo)
  (invulnerable)
  (endless-dark)
  (scene-player-1)
  (scene-player-2)
  (scene-player-3)
  (level-select)
  (scrap-book-1)
  (scrap-book-2)
  (scrap-book-3)
  (gungame-blue)
  (gungame-dark)
  (reverse-races)
  (hero-mode)
  (big-head)
  (little-head)
  (game-secret-unknown))
;; ---game-secrets

(defenum game-score
  (none)
  (race-1)
  (race-2)
  (race-3)
  (gungame-red)
  (gungame-yellow)
  (gungame-blue)
  (gungame-dark)
  (onin-game)
  (whack)
  (judge-skatea)
  (bush-race-1)
  (bush-race-2)
  (bush-race-3)
  (bush-port)
  (bush-errol)
  (reverse-race-1)
  (reverse-race-2)
  (reverse-race-3)
  )

(defenum highscore-flags
  :bitfield #t
  :type uint8
  (time)
  )

(declare-type game-info basic)
(define-extern *game-info* game-info)
(declare-type process-drawable process)
(define-extern process-drawable-art-error (state string process-drawable))
(define-extern part-group-pointer? (function pointer symbol))

;; NOTE - for default-menu
(define-extern bug-report-display (function symbol int))
(define-extern trsq->continue-point (function trsq int))

;; NOTE - for progress
(declare-type highscore-info structure)
(define-extern *highscore-info-array* (array highscore-info))

(declare-type entity-perm structure)
(define-extern *task-level* (array symbol))

;; DECOMP BEGINS

(local-vars (gp-0 game-info))

(deftype game-bank (basic)
  ((life-max-default   float  :offset-assert   4)
   (life-start-default float  :offset-assert   8)
   (life-single-inc    float  :offset-assert  12)
   (money-task-inc     float  :offset-assert  16)
   (money-oracle-inc   float  :offset-assert  20)
   )
  :method-count-assert 9
  :size-assert         #x18
  :flag-assert         #x900000018
  )


(define *GAME-bank* (new 'static 'game-bank
                      :life-max-default 99.0
                      :life-start-default 5.0
                      :life-single-inc 1.0
                      :money-task-inc 90.0
                      :money-oracle-inc 120.0
                      )
        )

(deftype actor-id (uint32)
  ()
  :method-count-assert 9
  :size-assert         #x4
  :flag-assert         #x900000004
  )

(deftype highscore-info (structure)
  ((flags        highscore-flags   :offset-assert   0)
   (award-scores float           3 :offset-assert   4)
   (bronze-score float             :offset          4)
   (silver-score float             :offset          8)
   (gold-score   float             :offset         12)
   )
  :method-count-assert 10
  :size-assert         #x10
  :flag-assert         #xa00000010
  (:methods
    (get-rank (_type_ float) int 9)
    )
  )


(deftype level-buffer-state (structure)
  ((name          symbol  :offset-assert   0)
   (display?      symbol  :offset-assert   4)
   (force-vis?    symbol  :offset-assert   8)
   (force-inside? symbol  :offset-assert  12)
   )
  :pack-me
  :method-count-assert 9
  :size-assert         #x10
  :flag-assert         #x900000010
  )


(deftype load-state (basic)
  ((want          level-buffer-state LEVEL_MAX :inline :offset-assert   4)
   (want-sound    symbol             3         :offset-assert 100)
   (vis-nick      symbol                       :offset-assert 112)
   (command-list  pair                         :offset-assert 116)
   (object-name   string             256       :offset-assert 120)
   (object-status basic              256       :offset-assert 1144)
   )
  :method-count-assert 22
  :size-assert         #x878
  :flag-assert         #x1600000878
  (:methods
    (new (symbol type) _type_ 0)
    (reset! (_type_) _type_ 9)
    (update! (_type_) int 10)
    (want-levels (_type_ (pointer symbol)) int 11)
    (want-sound-banks (_type_ (pointer symbol)) none 12)
    (want-display-level (_type_ symbol symbol) int 13)
    (want-vis-level (_type_ symbol) none 14)
    (want-force-vis (_type_ symbol symbol) int 15)
    (want-force-inside (_type_ symbol symbol) none 16)
    (execute-commands-up-to (_type_ float) none 17)
    (backup-load-state-and-set-cmds (_type_ pair) int 18)
    (restore-load-state-and-cleanup (_type_) int 19)
    (restore-load-state (_type_) int 20)
    (add-borrow-levels (_type_) none 21)
    )
  )


(defmethod new load-state ((allocation symbol) (type-to-make type))
  (reset! (object-new allocation type-to-make (the-as int (-> type-to-make size))))
  )

(deftype continue-point (basic)
  ((name         string                       :offset-assert   4)
   (level        symbol                       :offset-assert   8)
   (flags        continue-flags               :offset-assert  12)
   (trans        vector             :inline   :offset-assert  16)
   (quat         vector             :inline   :offset-assert  32)
   (camera-trans vector             :inline   :offset-assert  48)
   (camera-rot   vector3s           3 :inline :offset-assert  64)
   (on-goto      pair                         :offset-assert 100)
   (vis-nick     symbol                       :offset-assert 104)
   (want         level-buffer-state 6 :inline :offset-assert 108)
   (want-sound   symbol             3         :offset-assert 204)
   )
  :method-count-assert 12
  :size-assert         #xd8
  :flag-assert         #xc000000d8
  (:methods
    (debug-draw (_type_) int 9)
    (continue-point-method-10 (_type_ load-state) continue-point 10)
    (move-camera! (_type_) none 11)
    )
  )


(deftype game-info (basic)
  ((mode                   symbol                         :offset-assert   4)
   (save-name              string                         :offset-assert   8)
   (life                   float                          :offset-assert  12)
   (life-max               float                          :offset-assert  16)
   (money                  float                          :offset-assert  20)
   (money-total            float                          :offset-assert  24)
   (money-per-level        uint8                       32 :offset-assert  28)
   (deaths-per-level       uint8                       32 :offset-assert  60)
   (buzzer-total           float                          :offset-assert  92)
   (fuel                   float                          :offset-assert  96)
   (gem                    float                          :offset-assert 100)
   (gem-total              float                          :offset-assert 104)
   (skill                  float                          :offset-assert 108)
   (skill-total            float                          :offset-assert 112)
   (karma                  float                          :offset-assert 116)
   (eco-pill-dark          float                          :offset-assert 120)
   (eco-pill-dark-total    float                          :offset-assert 124)
   (features               game-feature                   :offset-assert 128)
   (debug-features         game-feature                   :offset-assert 136)
   (secrets                game-secrets                   :offset-assert 144)
   (unknown-pad1           uint32                         :offset-assert 148)
   (purchase-secrets       game-secrets                   :offset-assert 152)
   (unknown-pad2           uint32                         :offset-assert 156)
   (gun-type               pickup-type                    :offset-assert 160)
   (gun-ammo               float                       4  :offset-assert 164)
   (shield                 float                          :offset-assert 180)
   (score                  float                          :offset-assert 184)
   (score-owner            handle                         :offset-assert 192)
   (timer                  time-frame                     :offset-assert 200)
   (timer-owner            handle                         :offset-assert 208)
   (timer-flash            symbol                         :offset-assert 216)
   (counter                float                          :offset-assert 220)
   (counter-flash          basic                          :offset-assert 224)
   (attack-id              uint32                         :offset-assert 228)
   (perm-list              entity-perm-array              :offset-assert 232)
   (task-perm-list         entity-perm-array              :offset-assert 236)
   (current-continue       continue-point                 :offset-assert 240)
   (last-continue          continue-point                 :offset-assert 244)
   (play-list              (array game-task-info)         :offset-assert 248)
   (sub-task-list          (array game-task-node-info)    :offset-assert 252)
   (mission-list           (array game-task-node-info)    :offset-assert 256)
   (task-counter           uint32                         :offset-assert 260)
   (unknown-pad6           (array uint16)                 :offset-assert 264)
   (level-opened           uint8                       32 :offset-assert 268)
   (total-deaths           int32                          :offset-assert 300)
   (continue-deaths        int32                          :offset-assert 304)
   (task-deaths            int32                          :offset-assert 308)
   (total-trys             int32                          :offset-assert 312)
   (game-start-time        time-frame                     :offset-assert 320)
   (continue-time          time-frame                     :offset-assert 328)
   (death-time             time-frame                     :offset-assert 336)
   (hit-time               time-frame                     :offset-assert 344)
   (task-pickup-time       time-frame                     :offset-assert 352)
   (unknown-array1         (array time-frame)             :offset-assert 360)
   (task-enter-times       (array time-frame)             :offset-assert 364)
   (task-in-times          (array time-frame)             :offset-assert 368)
   (death-pos              vector-array                   :offset        372)
   (stop-watch-start       uint64                         :offset-assert 376)
   (stop-watch-stop        uint64                         :offset-assert 384)
   (blackout-time          time-frame                     :offset-assert 392)
   (letterbox-time         time-frame                     :offset-assert 400)
   (hint-play-time         time-frame                     :offset-assert 408)
   (display-text-time      time-frame                     :offset-assert 416)
   (display-text-handle    handle                         :offset-assert 424)
   (death-movie-tick       int32                          :offset-assert 432)
   (want-auto-save         symbol                         :offset-assert 436)
   (auto-save-proc         handle                         :offset-assert 440)
   (auto-save-status       mc-status-code                 :offset-assert 448)
   (auto-save-card         int32                          :offset-assert 452)
   (auto-save-which        int32                          :offset-assert 456)
   (auto-save-count        int32                          :offset-assert 460)
   (pov-camera-handle      handle                         :offset-assert 464)
   (other-camera-handle    handle                         :offset-assert 472)
   (controller             handle                      2  :offset-assert 480)
   (race-timer             uint64                         :offset-assert 496)
   (race-current-lap-count int32                          :offset-assert 504)
   (race-total-lap-count   int32                          :offset-assert 508)
   (race-position          int32                          :offset-assert 512)
   (race-number-turbos     int32                          :offset-assert 516)
   (bot-health             float                       3  :offset-assert 520)
   (demo-state             uint32                         :offset-assert 532)
   (wanted-flash           symbol                         :offset-assert 536)
   (distance               float                          :offset-assert 540)
   (kiosk-timeout          uint64                         :offset-assert 544)
   (pause-start-time       time-frame                     :offset-assert 552)
   (game-score             (array float)                  :offset-assert 560)
   (goal                   float                          :offset-assert 564)
   (miss                   float                          :offset-assert 568)
   (miss-max               float                          :offset-assert 572)
   (task-close-times       (array time-frame)             :offset-assert 576)
   (live-eco-pill-count    int32                          :offset-assert 580)
   (live-gem-count         int32                          :offset-assert 584)
   (air-supply             float                          :offset-assert 588)
   (homing-beacon          int32                          :offset-assert 592)
   (dark-eco-pickup        int32                          :offset-assert 596)
   (green-eco-pickup       int32                          :offset-assert 600)
   )
  :method-count-assert 31
  :size-assert         #x25c
  :flag-assert         #x1f0000025c
  (:methods
    (initialize! (_type_ symbol game-save string) _type_ 9)
    (give (_type_ symbol float handle) float 10)
    (task-complete? (_type_ game-task) symbol 11)
    (subtask-index-by-name (_type_ string) int 12)
    (set-subtask-hook! (_type_ game-task-node int function) function 13)
    (actor-perm (_type_ actor-id) entity-perm 14)
    (task-perm-by-index (_type_ int) entity-perm 15)
    (copy-perms-from-level! (_type_ level) int 16)
    (copy-perms-to-level! (_type_ level) int 17)
    (debug-inspect (_type_ symbol) _type_ 18)
    (get-current-continue-forced (_type_) continue-point 19)
    (get-continue-by-name (_type_ string) continue-point 20)
    (set-continue! (_type_ basic symbol) continue-point 21)
    (game-info-method-22 (_type_) int 22)
    (save-game (_type_ game-save string) game-save 23)
    (load-game (_type_ game-save) game-save 24)
    (you-suck-stage (_type_ symbol) int 25)
    (you-suck-scale (_type_ object) float 26)
    (get-next-attack-id (_type_) uint 27)
    (game-info-method-28 (_type_ game-score float) int 28)
    (get-game-score-ref (_type_ int) (pointer float) 29)
    (calculate-percentage (_type_) float 30)
    )
  )


(defmethod get-next-attack-id game-info ((this game-info))
  (let ((v0-0 (+ (-> this attack-id) 1)))
    (set! (-> this attack-id) v0-0)
    v0-0
    )
  )

(set! gp-0
      (when (or (not *game-info*) (zero? *game-info*))
        (set! gp-0 (new 'static 'game-info :mode 'debug :current-continue #f :last-continue #f))
        (set! (-> gp-0 unknown-array1) (the-as (array time-frame) (new 'global 'boxed-array uint64 110)))
        (set! (-> gp-0 task-close-times) (the-as (array time-frame) (new 'global 'boxed-array uint64 110)))
        (set! (-> gp-0 task-enter-times) (the-as (array time-frame) (new 'global 'boxed-array uint64 32)))
        (set! (-> gp-0 task-in-times) (the-as (array time-frame) (new 'global 'boxed-array uint64 32)))
        (set! *game-info* gp-0)
        gp-0
        )
      )
