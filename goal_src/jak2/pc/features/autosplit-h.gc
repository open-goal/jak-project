;;-*-Lisp-*-
(in-package goal)

;; LiveSplit ASL requires all settings to initalized _before_ you connect the process
;; Therefore everything has to be laid out in a predictable fashion before hand
;; So this is a lot of hard-coding, but not too bad when just copied from the debug menu code
;;
;; DO NOT change the order, appending to the end is safe!

(deftype autosplit-info-jak2 (structure)
  (;; Version Info
   (version-major uint16)
   (version-minor uint16)
   ;; General stats
   (num-orbs uint32)
   (num-skullgems uint32)
   (padding-stats uint8 200) ;; padding for future growth
   ;; loading/cutscene/control related info
   (game-hash uint32)
   (in-cutscene? uint8)
   (is-loading? uint8)
   (padding-controls uint8 200) ;; padding for future growth
   ;; need-resolution tasks
   (res-fortress-escape uint8)
   (res-city-help-kid uint8)
   (res-city-vehicle-training uint8)
   (res-ruins-tower uint8)
   (res-atoll-water uint8)
   (res-fortress-dump uint8)
   (res-city-krew-delivery uint8)
   (res-city-red-gun-training uint8)
   (res-atoll-sig uint8)
   (res-sewer-enemy uint8)
   (res-strip-rescue uint8)
   (res-atoll-battle uint8)
   (res-mountain-lens uint8)
   (res-mountain-gear uint8)
   (res-mountain-shard uint8)
   (res-mountain-collection uint8)
   (res-city-keira-delivery uint8)
   (res-stadium-board1 uint8)
   (res-city-krew-collection uint8)
   (res-city-yellow-gun-training uint8)
   (res-drill-eggs uint8)
   (res-city-power uint8)
   (res-palace-cable uint8)
   (res-palace-boss uint8)
   (res-city-shuttle uint8)
   (res-ruins-enemy uint8)
   (res-city-blue-gun-training uint8)
   (res-forest-scouts uint8)
   (res-city-escort-kid uint8)
   (res-dig-knock-down uint8)
   (res-strip-grenade uint8)
   (res-drill-ship uint8)
   (res-city-port-run uint8)
   (res-city-meet-brutter uint8)
   (res-sewer-board uint8)
   (res-forest-hunt uint8)
   (res-city-intercept-tanker uint8)
   (res-stadium-race-class3 uint8)
   (res-city-protect-water-slums uint8)
   (res-dig-find-totem uint8)
   (res-city-destroy-guard-vehicles uint8)
   (res-city-play-onin-game uint8)
   (res-canyon-insert-items uint8)
   (res-tomb-poles uint8)
   (res-tomb-water uint8)
   (res-tomb-boss uint8)
   (res-fortress-save-friends uint8)
   (res-sewer-escort uint8)
   (res-city-dark-gun-training uint8)
   (res-stadium-race-class2 uint8)
   (res-city-stop-bomb-bots uint8)
   (res-city-errol-challenge uint8)
   (res-strip-drop uint8)
   (res-ruins-mech uint8)
   (res-forest-protect uint8)
   (res-drill-mech uint8)
   (res-city-save-lurkers uint8)
   (res-stadium-race-class uint8)
   (res-palace-sneak-in uint8)
   (res-castle-break-in uint8)
   (res-castle-boss uint8)
   (res-city-whack uint8)
   (res-under-mech uint8)
   (res-under-sig uint8)
   (res-city-defend-stadium uint8)
   (res-consite-find-baron uint8)
   (res-nest-get-to-gun uint8)
   (res-nest-enter uint8)
   (res-nest-boss uint8)
   (res-city-win uint8)
   (res-city-oracle uint8)
   (res-city-burning-bush-ring-1 uint8)
   (res-city-burning-bush-get-to-1 uint8)
   (res-city-burning-bush-get-to-2 uint8)
   (res-city-burning-bush-get-to-3 uint8)
   (res-city-burning-bush-get-to-4 uint8)
   (res-city-burning-bush-collection-1 uint8)
   (res-city-burning-bush-racepoint-1 uint8)
   (res-city-burning-bush-ring-2 uint8)
   (res-city-burning-bush-get-to-5 uint8)
   (res-city-burning-bush-get-to-6 uint8)
   (res-city-burning-bush-shuttle-1 uint8)
   (res-city-burning-bush-get-to-7 uint8)
   (res-city-burning-bush-get-to-8 uint8)
   (res-city-burning-bush-get-to-9 uint8)
   (res-city-burning-bush-collection-2 uint8)
   (res-city-burning-bush-get-to-10 uint8)
   (res-city-burning-bush-get-to-11 uint8)
   (res-city-burning-bush-ring-3 uint8)
   (res-city-burning-bush-get-to-12 uint8)
   (res-city-burning-bush-bombbot-1 uint8)
   (res-city-burning-bush-get-to-13 uint8)
   (res-city-burning-bush-get-to-14 uint8)
   (res-city-burning-bush-get-to-15 uint8)
   (res-city-burning-bush-collection-3 uint8)
   (res-city-burning-bush-race-errol uint8)
   (res-city-burning-bush-race-port uint8)
   (res-stadium-burning-bush-race-board uint8)
   (res-stadium-burning-bush-race-class3 uint8)
   (res-stadium-burning-bush-race-class2 uint8)
   (res-stadium-burning-bush-race-class1 uint8)
   (res-stadium-burning-bush-race-class3-r uint8)
   (res-stadium-burning-bush-race-class2-r uint8)
   (res-stadium-burning-bush-race-class1-r uint8)
   ;; TODO - orbs in level X
   ;; end marker just to make things look nice in a memory view
   (end-marker uint8 4)))

(define-extern *autosplit-info-jak2* autosplit-info-jak2)
(define-extern update-autosplit-info-jak2 (function none))
(define-extern update-autosplit-jak2-new-game (function none))
