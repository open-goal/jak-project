;;-*-Lisp-*-
(in-package goal)

;; name: ctywide-bbush.gc
;; name in dgo: ctywide-bbush
;; dgos: LBBUSH

(declare-type city-race-ring-info structure)

;; DECOMP BEGINS

(defpartgroup group-rolling-ring
  :id 1053
  :linger-duration (seconds 0)
  :bounds (static-bspherem 0 0 0 8)
  :parts ((sp-item 4578 :fade-after (meters 100) :falloff-to (meters 100))
    (sp-item 4579 :fade-after (meters 80))
    (sp-item 4580 :flags (is-3d))
    (sp-item 4581 :flags (is-3d))
    )
  )

(defpart 4578
  :init-specs ((:texture (new 'static 'texture-id :index #x29 :page #xc))
    (:num 2.0 2.0)
    (:scale-x (meters 1) (meters 1))
    (:rot-z (degrees 0) (degrees 360))
    (:scale-y :copy scale-x)
    (:r 64.0 1 64.0)
    (:g 0.0)
    (:b 64.0 1 64.0)
    (:a 64.0)
    (:rotvel-z (degrees -0.2) (degrees 0.4))
    (:fade-a -1.4222221)
    (:timer (seconds 0.14))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3))
    (:conerot-x (degrees 0) (degrees 360))
    (:rotate-y (degrees 0))
    (:conerot-radius (meters 4.5))
    )
  )

(defpart 4579
  :init-specs ((:texture (new 'static 'texture-id :index #x29 :page #xc))
    (:num 1.0)
    (:scale-x (meters 1) (meters 4))
    (:rot-z (degrees 0) (degrees 360))
    (:scale-y :copy scale-x)
    (:r 64.0 1 64.0)
    (:g 0.0)
    (:b 64.0 1 64.0)
    (:a 64.0)
    (:rotvel-z (degrees -0.2) (degrees 0.4))
    (:fade-a -1.4222221)
    (:timer (seconds 0.14))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3))
    (:conerot-x (degrees 0) (degrees 360))
    (:rotate-y (degrees 0))
    (:conerot-radius (meters 4.5))
    )
  )

(defpart 4580
  :init-specs ((:texture (new 'static 'texture-id :index #x2c :page #xc))
    (:num 1.0)
    (:scale-x (meters 10))
    (:rot-x (degrees 0) (degrees 360))
    (:rot-y (degrees -1) (degrees 2))
    (:rot-z (degrees 90))
    (:scale-y :copy scale-x)
    (:r 128.0 1 127.0)
    (:g 0.0)
    (:b 128.0 1 127.0)
    (:a 96.0 32.0)
    (:fade-a -8.533334)
    (:timer (seconds 0.035))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3))
    )
  )

(defpart 4581
  :init-specs ((:texture (new 'static 'texture-id :index #x26 :page #xc))
    (:num 1.0)
    (:scale-x (meters 12))
    (:rot-x (degrees 0) (degrees 360))
    (:rot-y (degrees 0))
    (:rot-z (degrees 90))
    (:scale-y :copy scale-x)
    (:r 128.0 1 127.0)
    (:g 0.0)
    (:b 128.0 1 127.0)
    (:a 32.0 32.0)
    (:timer (seconds 0.017))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3))
    )
  )

(defpartgroup group-rolling-spawn-ring
  :id 1054
  :duration (seconds 0.017)
  :linger-duration (seconds 0.47)
  :bounds (static-bspherem 0 0 0 8)
  :parts ((sp-item 4582 :fade-after (meters 100) :falloff-to (meters 100))
    (sp-item 4583 :flags (is-3d))
    (sp-item 4584 :flags (is-3d))
    )
  )

(defpart 4582
  :init-specs ((:texture (new 'static 'texture-id :index #x29 :page #xc))
    (:num 32.0)
    (:scale-x (meters 1) (meters 3))
    (:rot-z (degrees 0) (degrees 360))
    (:scale-y :copy scale-x)
    (:r 64.0 1 64.0)
    (:g 0.0)
    (:b 64.0 1 64.0)
    (:a 0.0 63 1.0)
    (:vel-y (meters 0.03))
    (:rotvel-z (degrees -0.2) (degrees 0.4))
    (:timer (seconds 0.5))
    (:flags (sp-cpuinfo-flag-3))
    (:next-time (seconds 0.067) (seconds 0.065))
    (:next-launcher 4585)
    (:conerot-x (degrees 0) (degrees 360))
    (:rotate-y (degrees 0))
    (:conerot-radius (meters 0))
    )
  )

(defpart 4585
  :init-specs ((:r 64.0 1 64.0)
    (:g 0.0)
    (:b 64.0 1 64.0)
    (:a 0.0 63 1.0)
    (:next-time (seconds 0.067) (seconds 0.065))
    (:next-launcher 4585)
    )
  )

(defpart 4583
  :init-specs ((:texture (new 'static 'texture-id :index #x2c :page #xc))
    (:num 1.0)
    (:scale-x (meters 0))
    (:rot-x (degrees 0) (degrees 360))
    (:rot-y (degrees -1) (degrees 2))
    (:rot-z (degrees 90))
    (:scale-y :copy scale-x)
    (:r 128.0 1 127.0)
    (:g 0.0)
    (:b 128.0 1 127.0)
    (:a 96.0 32.0)
    (:scalevel-x (meters 0.06666667))
    (:scalevel-y :copy scalevel-x)
    (:timer (seconds 0.5))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3 left-multiply-quat))
    (:next-time (seconds 0.017))
    (:next-launcher 4586)
    )
  )

(defpart 4586
  :init-specs ((:r 128.0 1 127.0)
    (:g 0.0)
    (:b 128.0 1 127.0)
    (:a 32.0 32.0)
    (:next-time (seconds 0.017))
    (:next-launcher 4586)
    )
  )

(defpart 4584
  :init-specs ((:texture (new 'static 'texture-id :index #x26 :page #xc))
    (:num 1.0)
    (:scale-x (meters 0))
    (:rot-x (degrees 0) (degrees 360))
    (:rot-y (degrees 0))
    (:rot-z (degrees 90))
    (:scale-y :copy scale-x)
    (:r 128.0 1 127.0)
    (:g 0.0)
    (:b 128.0 1 127.0)
    (:a 32.0 32.0)
    (:scalevel-x (meters 0.08))
    (:scalevel-y :copy scalevel-x)
    (:timer (seconds 0.5))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3 left-multiply-quat))
    (:next-time (seconds 0.017))
    (:next-launcher 4587)
    )
  )

(defpart 4587
  :init-specs ((:r 128.0 1 127.0)
    (:g 0.0)
    (:b 128.0 1 127.0)
    (:a 32.0 32.0)
    (:next-time (seconds 0.017))
    (:next-launcher 4587)
    )
  )

(defpartgroup group-rolling-explode-ring
  :id 1055
  :duration (seconds 0.017)
  :linger-duration (seconds 0.5)
  :bounds (static-bspherem 0 0 0 8)
  :parts ((sp-item 4588 :fade-after (meters 100) :falloff-to (meters 100)) (sp-item 4589 :flags (is-3d)))
  )

(defpart 4588
  :init-specs ((:texture (new 'static 'texture-id :index #x29 :page #xc))
    (:num 64.0)
    (:scale-x (meters 1) (meters 1))
    (:rot-z (degrees 0) (degrees 360))
    (:scale-y :copy scale-x)
    (:r 64.0 1 64.0)
    (:g 0.0)
    (:b 64.0 1 64.0)
    (:a 32.0 96.0)
    (:vel-y (meters 0.1) (meters 0.033333335))
    (:rotvel-z (degrees -0.2) (degrees 0.4))
    (:fade-a -0.85333335)
    (:friction 0.9)
    (:timer (seconds 0.5))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3))
    (:conerot-x (degrees 0) (degrees 360))
    (:rotate-y (degrees 0))
    (:conerot-radius (meters 4.5))
    )
  )

(defpart 4589
  :init-specs ((:texture (new 'static 'texture-id :index #x2c :page #xc))
    (:num 2.0)
    (:scale-x (meters 10))
    (:rot-x (degrees 0) (degrees 360))
    (:rot-y (degrees -1) (degrees 2))
    (:rot-z (degrees 90))
    (:scale-y :copy scale-x)
    (:r 128.0 1 127.0)
    (:g 0.0)
    (:b 128.0 1 127.0)
    (:a 128.0)
    (:scalevel-x (meters 0.06666667))
    (:scalevel-y :copy scalevel-x)
    (:fade-a -0.85333335)
    (:timer (seconds 0.5))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3))
    )
  )

(deftype race-ring (process-drawable)
  ((last-target-pos       vector        :inline :offset-assert 208)
   (keep-part-track-alive symbol                :offset-assert 224)
   (part-track            handle                :offset-assert 232)
   (rot-y                 float                 :offset-assert 240)
   (cyl                   cylinder-flat :inline :offset-assert 256)
   )
  :heap-base #xb0
  :method-count-assert 24
  :size-assert         #x128
  :flag-assert         #x1800b00128
  (:methods
    (idle () _type_ :state 20)
    (die () _type_ :state 21)
    (race-ring-method-22 (_type_) none 22)
    (race-ring-method-23 (_type_) none 23)
    )
  )


(defun race-ring-set-particle-rotation-callback ((arg0 part-tracker))
  (let ((f0-0 (-> (the-as (pointer race-ring) (-> arg0 userdata)) 0 rot-y)))
    (set! (-> *part-id-table* 4578 init-specs 14 initial-valuef) f0-0)
    (set! (-> *part-id-table* 4579 init-specs 14 initial-valuef) f0-0)
    (set! (-> *part-id-table* 4580 init-specs 4 initial-valuef) (+ -182.04445 f0-0))
    (set! (-> *part-id-table* 4581 init-specs 4 initial-valuef) f0-0)
    (set! (-> *part-id-table* 4582 init-specs 16 initial-valuef) f0-0)
    (set! (-> *part-id-table* 4583 init-specs 4 initial-valuef) f0-0)
    (set! (-> *part-id-table* 4584 init-specs 4 initial-valuef) f0-0)
    (set! (-> *part-id-table* 4588 init-specs 16 initial-valuef) f0-0)
    (set! (-> *part-id-table* 4589 init-specs 4 initial-valuef) f0-0)
    )
  0
  (none)
  )

(defstate idle (race-ring)
  :virtual #t
  :enter (behavior ()
    (let ((gp-0 (get-process *default-dead-pool* part-tracker #x4000)))
      (set! (-> self part-track)
            (ppointer->handle
              (when gp-0
                (let ((t9-1 (method-of-type part-tracker activate)))
                  (t9-1 (the-as part-tracker gp-0) self (symbol->string (-> part-tracker symbol)) (the-as pointer #x70004000))
                  )
                (let ((t9-2 run-function-in-process)
                      (a0-2 gp-0)
                      (a1-2 part-tracker-init)
                      (a2-4 (-> *part-group-id-table* 1054))
                      (a3-1 0)
                      (t0-0 race-ring-set-particle-rotation-callback)
                      (t1-0 (-> self ppointer))
                      (t2-0 #f)
                      (t3-0 *launch-matrix*)
                      )
                  (set! (-> t3-0 trans quad) (-> self root trans quad))
                  ((the-as (function object object object object object object object object none) t9-2)
                   a0-2
                   a1-2
                   a2-4
                   a3-1
                   t0-0
                   t1-0
                   t2-0
                   t3-0
                   )
                  )
                (-> gp-0 ppointer)
                )
              )
            )
      )
    (none)
    )
  :exit (behavior ()
    (let ((a0-1 (handle->process (-> self part-track))))
      (if a0-1
          (deactivate a0-1)
          )
      )
    (let ((gp-0 (get-process *default-dead-pool* part-tracker #x4000)))
      (set! (-> self part-track)
            (ppointer->handle
              (when gp-0
                (let ((t9-2 (method-of-type part-tracker activate)))
                  (t9-2 (the-as part-tracker gp-0) self (symbol->string (-> part-tracker symbol)) (the-as pointer #x70004000))
                  )
                (let ((t9-3 run-function-in-process)
                      (a0-6 gp-0)
                      (a1-3 part-tracker-init)
                      (a2-4 (-> *part-group-id-table* 1055))
                      (a3-1 0)
                      (t0-0 race-ring-set-particle-rotation-callback)
                      (t1-0 (-> self ppointer))
                      (t2-0 #f)
                      (t3-0 *launch-matrix*)
                      )
                  (set! (-> t3-0 trans quad) (-> self root trans quad))
                  ((the-as (function object object object object object object object object none) t9-3)
                   a0-6
                   a1-3
                   a2-4
                   a3-1
                   t0-0
                   t1-0
                   t2-0
                   t3-0
                   )
                  )
                (-> gp-0 ppointer)
                )
              )
            )
      )
    (none)
    )
  :trans (behavior ()
    (cond
      ((handle->process (-> self part-track))
       (if (-> self keep-part-track-alive)
           (set! (-> (the-as part-tracker (-> self part-track process 0)) start-time) (current-time))
           )
       )
      (else
        (let ((gp-0 (get-process *default-dead-pool* part-tracker #x4000)))
          (set! (-> self part-track)
                (ppointer->handle
                  (when gp-0
                    (let ((t9-1 (method-of-type part-tracker activate)))
                      (t9-1 (the-as part-tracker gp-0) self (symbol->string (-> part-tracker symbol)) (the-as pointer #x70004000))
                      )
                    (let ((t9-2 run-function-in-process)
                          (a0-9 gp-0)
                          (a1-3 part-tracker-init)
                          (a2-4 (-> *part-group-id-table* 1053))
                          (a3-1 0)
                          (t0-0 race-ring-set-particle-rotation-callback)
                          (t1-0 (-> self ppointer))
                          (t2-0 #f)
                          (t3-0 *launch-matrix*)
                          )
                      (set! (-> t3-0 trans quad) (-> self root trans quad))
                      ((the-as (function object object object object object object object object none) t9-2)
                       a0-9
                       a1-3
                       a2-4
                       a3-1
                       t0-0
                       t1-0
                       t2-0
                       t3-0
                       )
                      )
                    (-> gp-0 ppointer)
                    )
                  )
                )
          )
        (set! (-> self keep-part-track-alive) #t)
        )
      )
    (let ((v1-17 *target*)
          (gp-1 (new 'stack-no-clear 'vector))
          )
      (when v1-17
        (set! (-> gp-1 quad) (-> v1-17 control trans quad))
        (set! (-> gp-1 w) 4096.0)
        (when (focus-test? v1-17 pilot)
          (let ((a1-8 (handle->process (-> v1-17 pilot vehicle))))
            (set! (-> gp-1 quad) (-> (the-as process-focusable a1-8) root-override root-prim prim-core world-sphere quad))
            )
          )
        (when (>= (ray-flat-cyl-intersect
                    (-> self cyl)
                    (-> self last-target-pos)
                    (vector-! (new 'stack-no-clear 'vector) gp-1 (-> self last-target-pos))
                    )
                  0.0
                  )
          (set! (-> *game-info* counter) (+ -1.0 (-> *game-info* counter)))
          (sound-play "ring-pickup")
          (go-virtual die)
          )
        (set! (-> self last-target-pos quad) (-> gp-1 quad))
        )
      )
    (none)
    )
  :code (behavior ()
    (until #f
      (suspend)
      )
    #f
    (none)
    )
  :post (the-as (function none :behavior race-ring) ja-post)
  )

(defstate die (race-ring)
  :virtual #t
  :code (behavior ()
    (while (-> self child)
      (suspend)
      )
    (cleanup-for-death self)
    (none)
    )
  )

(defmethod race-ring-method-22 race-ring ((obj race-ring))
  (set! (-> obj root) (new 'process 'trsqv))
  0
  (none)
  )

(defmethod race-ring-method-23 race-ring ((obj race-ring))
  (add-icon! *minimap* obj (the-as uint 15) (the-as int #f) (the-as vector #t) 0)
  (set! (-> obj keep-part-track-alive) #f)
  (set! (-> obj part-track) (the-as handle #f))
  (set! (-> obj rot-y) (+ 16384.0 (quaternion-y-angle (-> obj root quat))))
  (set! (-> obj last-target-pos quad) (-> (target-pos 0) quad))
  (set-vector! (-> obj cyl axis) (cos (-> obj rot-y)) 0.0 (- (sin (-> obj rot-y))) 1.0)
  (vector+float*! (the-as vector (-> obj cyl)) (-> obj root trans) (-> obj cyl axis) -2048.0)
  (set! (-> obj cyl radius) 24576.0)
  (set! (-> obj cyl length) 4096.0)
  0
  (none)
  )

;; WARN: Return type mismatch object vs none.
(defbehavior race-ring-init-by-other race-ring ((arg0 city-race-ring-info))
  (race-ring-method-22 self)
  (set! (-> self root trans quad) (-> arg0 pos quad))
  (set! (-> self root trans y) (+ 10240.0 (-> self root trans y)))
  (quaternion-axis-angle! (-> self root quat) 0.0 1.0 0.0 (-> arg0 pos w))
  (set-vector! (-> self root scale) 3.0 3.0 3.0 1.0)
  (race-ring-method-23 self)
  (go-virtual idle)
  (none)
  )

(defun race-ring-spawn ((arg0 task-manager) (arg1 city-race-ring-info))
  (let ((gp-0 (the-as process #f)))
    (let ((v1-1 (process-spawn race-ring arg1 :to arg0)))
      (if v1-1
          (set! gp-0 (-> v1-1 0))
          )
      )
    gp-0
    )
  )

(deftype bb-ring-info (structure)
  ((time      time-frame                          :offset-assert   0)
   (start-pos vector                      :inline :offset-assert  16)
   (rotation  float                               :offset-assert  32)
   (rings     (array city-race-ring-info)         :offset-assert  36)
   )
  :method-count-assert 9
  :size-assert         #x28
  :flag-assert         #x900000028
  )


(define *bb-ring-info* (new 'static 'boxed-array :type bb-ring-info
                         (new 'static 'bb-ring-info
                           :time (seconds 8)
                           :start-pos (new 'static 'vector :x 2920693.8 :y 40960.0 :z -333086.72 :w 1.0)
                           :rings (new 'static 'boxed-array :type city-race-ring-info
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3070796.2 :y 43205.02 :z -289035.47 :w 8995.472)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3351872.0 :y 42851.125 :z 86396.11 :w 14760.418)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3540834.8 :y 72001.54 :z 367432.5 :w 4834.5728)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3950253.8 :y 43052.24 :z 800616.06 :w 5659.835)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4657052.5 :y 42684.414 :z 806750.6 :w 8782.443)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4643791.5 :y 70061.67 :z 1225949.6 :w -7646.1035)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4473472.0 :y 46644.84 :z 1626665.4 :w 1340.4115)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4650624.0 :y 62401.332 :z 1927367.1 :w 32186.242)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4236069.5 :y 109972.69 :z 1854959.2 :w -13605.638)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3701647.0 :y 113170.84 :z 1698812.8 :w -2880.9443)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3724027.5 :y 111864.22 :z 2344453.0 :w 11307.618)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4235592.5 :y 109263.26 :z 2386389.0 :w 16874.646)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4495594.5 :y 101352.66 :z 2342717.5 :w 19199.955)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4557376.5 :y 44639.848 :z 2683306.0 :w -17726.906)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4011281.2 :y 72860.47 :z 2645215.8 :w -4971.9067)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3543313.2 :y 47093.76 :z 2577456.0 :w -16974.389)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3204822.2 :y 74465.28 :z 2832405.8 :w 1022.9805)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3519941.5 :y 115895.09 :z 3035037.8 :w 3764.133)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3583739.5 :y 112346.32 :z 3433880.0 :w 15266.283)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3925602.0 :y 115456.82 :z 3560821.2 :w 12493.182)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4214438.5 :y 109173.15 :z 3710432.5 :w 3543.022)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4292878.5 :y 113903.62 :z 4136553.8 :w 13073.904)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4557998.5 :y 108473.14 :z 4093858.2 :w 32527.1)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4457908.0 :y 44532.94 :z 3678150.8 :w -16948.848)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3962912.0 :y 42423.09 :z 3524606.0 :w 24137.527)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4440953.0 :y 42390.734 :z 3293434.8 :w 31590.809)
                               :boost 1.0
                               :dist 819200.0
                               )
                             )
                           )
                         (new 'static 'bb-ring-info
                           :time (seconds 8)
                           :start-pos (new 'static 'vector :x 2920693.8 :y 40960.0 :z -333086.72 :w 1.0)
                           :rings (new 'static 'boxed-array :type city-race-ring-info
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3139584.0 :y 44933.12 :z -241909.77 :w 11339.948)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3277373.5 :y 43704.32 :z 74997.76 :w 912.3522)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3299614.8 :y 44154.88 :z 331161.6 :w 10465.48)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3607593.0 :y 43499.52 :z 518348.8 :w 10608.295)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3971440.8 :y 43663.36 :z 760791.06 :w 13600.504)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4258160.5 :y 70328.32 :z 666501.1 :w -27694.55)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4070359.0 :y 47759.36 :z 576512.0 :w -14751.389)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3680379.0 :y 44564.48 :z 557219.8 :w -23942.902)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3503718.5 :y 69386.24 :z 223313.92 :w -30764.584)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3272827.0 :y 45301.76 :z -13557.76 :w -31219.184)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3041034.2 :y 44195.84 :z -319651.84 :w -23914.998)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3087073.2 :y 76062.72 :z -667197.44 :w 30212.334)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2988114.0 :y 108503.04 :z -1128489.0 :w -27177.633)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2576220.2 :y 45916.16 :z -1328578.5 :w -20707.338)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2293514.2 :y 43048.96 :z -887357.44 :w 4091.8494)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2675425.2 :y 81305.6 :z -856965.1 :w 26134.191)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2693283.8 :y 45096.96 :z -1273528.4 :w -14476.319)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2442444.8 :y 115056.64 :z -1190461.5 :w -8945.955)
                               :boost 1.0
                               :dist 819200.0
                               )
                             )
                           )
                         (new 'static 'bb-ring-info
                           :time (seconds 8)
                           :start-pos (new 'static 'vector :x -370606.1 :y 40960.0 :z 5572239.5 :w 1.0)
                           :rotation 5461.3335
                           :rings (new 'static 'boxed-array :type city-race-ring-info
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x -280739.84 :y 47308.8 :z 5591818.0 :w 17184.613)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 69754.88 :y 13557.76 :z 5583257.5 :w 17541.584)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 576348.2 :y 49766.4 :z 5611397.0 :w 18388.31)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 895426.56 :y 59064.32 :z 5211177.0 :w -32356.96)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 691732.5 :y 30965.76 :z 4855562.0 :w -30837.783)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 763248.6 :y 46817.28 :z 4489339.0 :w -28816.58)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 416481.28 :y 44072.96 :z 4337705.0 :w -25147.764)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 425902.1 :y 45178.88 :z 3870433.2 :w 30427.8)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 703938.56 :y 71966.72 :z 3478118.5 :w 24663.018)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 932904.94 :y 47472.64 :z 3203932.2 :w 21617.414)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 1308098.5 :y 105881.6 :z 3228221.5 :w 15657.807)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 1547509.8 :y 76431.36 :z 2849013.8 :w 24128.59)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 1756979.2 :y 34570.24 :z 2779422.8 :w 17599.62)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 1975337.0 :y 34406.4 :z 2847703.0 :w 5692.511)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2331156.5 :y 59473.92 :z 3134095.2 :w 14885.848)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2582814.8 :y 34406.4 :z 2942525.5 :w -28780.717)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2701680.8 :y 60620.8 :z 2638069.8 :w 17277.092)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2992455.8 :y 39731.2 :z 2504335.2 :w 31740.521)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2741084.2 :y 90112.0 :z 2380021.8 :w -20174.584)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2684067.8 :y 95887.36 :z 2128937.0 :w -32377.205)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 2793758.8 :y 100024.32 :z 1767751.6 :w 17577.355)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3154288.8 :y 45711.36 :z 1753169.9 :w 13975.443)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3440558.0 :y 47349.76 :z 2188411.0 :w 12108.886)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3902546.0 :y 44523.52 :z 2269511.8 :w 19725.771)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3993600.0 :y 46407.68 :z 2011054.1 :w 31902.232)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4441415.5 :y 72171.52 :z 1879900.1 :w 10530.943)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4650066.0 :y 86835.2 :z 1856430.1 :w -32374.768)
                               :boost 1.0
                               :dist 819200.0
                               )
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 4532306.0 :y 87572.48 :z 1644830.8 :w -29740.656)
                               :boost 1.0
                               :dist 819200.0
                               )
                             )
                           )
                         (new 'static 'bb-ring-info
                           :time (seconds 8)
                           :rings (new 'static 'boxed-array :type city-race-ring-info
                             (new 'static 'city-race-ring-info
                               :pos (new 'static 'vector :x 3139584.0 :y 44933.12 :z -241909.77 :w 11339.948)
                               :boost 1.0
                               :dist 819200.0
                               )
                             )
                           )
                         )
        )

(define *city-race-ring-edit-info* (new 'static 'array int32 512
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     0
                                     )
        )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-ring-1-resolution)
  TASK_MANAGER_INIT_HOOK
  (lambda :behavior task-manager
    ()
    (set-setting! 'minimap 'clear 0.0 (minimap-flag task-graph))
    (set-setting! 'airlock #f 0.0 0)
    (set-setting! 'exclusive-task #f 0.0 (-> self node-info task))
    (let ((s5-0 *traffic-manager*)
          (gp-0 (new 'stack 'traffic-object-spawn-params))
          )
      (set! (-> gp-0 position quad) (-> *bb-ring-info* (-> self info index) start-pos quad))
      (quaternion-axis-angle! (-> gp-0 rotation) 0.0 1.0 0.0 (-> *bb-ring-info* (-> self info index) rotation))
      (set! (-> gp-0 object-type) (traffic-type bikea))
      (set! (-> gp-0 behavior) (the-as uint 0))
      (set! (-> gp-0 id) (the-as uint 0))
      (set! (-> gp-0 proc) #f)
      (send-event s5-0 'spawn-object gp-0)
      (if (-> gp-0 proc)
          (set! (-> self slave 1) (process->handle (-> gp-0 proc)))
          )
      )
    (set! (-> self start-time) 0)
    (set! (-> self sub-state) (the-as uint 0))
    (set! (-> self count) 0)
    (set! (-> self max-count) (-> *bb-ring-info* (-> self info index) rings length))
    (none)
    )
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-ring-1-resolution)
  TASK_MANAGER_CLEANUP_HOOK
  (lambda :behavior task-manager () (send-event *traffic-manager* 'restore-default-settings) (none))
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-ring-1-resolution)
  TASK_MANAGER_UPDATE_HOOK
  (lambda :behavior task-manager
    ()
    (check-time self)
    (cond
      ((and (handle->process (-> self slave 0))
            (-> self slave 0 process 0 next-state)
            (= (-> self slave 0 process 0 next-state name) 'idle)
            )
       )
      (else
        (let ((v1-15 (-> self sub-state)))
          (cond
            ((< v1-15 (the-as uint (-> self max-count)))
             (let* ((a1-2 (-> *bb-ring-info* (-> self info index) rings v1-15))
                    (a0-14 (race-ring-spawn self a1-2))
                    )
               (when a0-14
                 (set! (-> self slave 0) (process->handle a0-14))
                 (set! (-> self time-limit) (the-as time-frame (if (zero? (-> self sub-state))
                                                                   4500
                                                                   (the-as int (-> *bb-ring-info* (-> self info index) time))
                                                                   )
                                                    )
                       )
                 (set! (-> self start-time) (current-time))
                 (+! (-> self sub-state) 1)
                 )
               )
             )
            (else
              (go-virtual complete)
              )
            )
          )
        )
      )
    (none)
    )
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-ring-1-resolution)
  TASK_MANAGER_CODE_HOOK
  (lambda :behavior task-manager
    ()
    (while (< (- (current-time) (-> self state-time)) (seconds 5))
      (suspend)
      )
    (none)
    )
  )

;; this is unnecessary. the task manager can close the task.
(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-ring-1-resolution)
  TASK_MANAGER_COMPLETE_HOOK
  (lambda :behavior task-manager () (close! (-> self node-info) 'event) (none))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-ring-2-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-ring-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-ring-3-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-ring-1-resolution))
  )

(defpartgroup group-bush-collect
  :id 1056
  :linger-duration (seconds 2)
  :flags (use-local-clock)
  :bounds (static-bspherem 0 0 0 2)
  :parts ((sp-item 4590 :fade-after (meters 220) :period (seconds 0.5) :length (seconds 0.25))
    (sp-item 4591 :fade-after (meters 100))
    )
  )

(defpart 4591
  :init-specs ((:texture (new 'static 'texture-id :index #xcb :page #xc))
    (:num 0.0 0.2)
    (:y (meters 2))
    (:scale-x (meters 0.1))
    (:rot-x (degrees 11.25))
    (:rot-z (degrees 0) (degrees 3600))
    (:scale-y :copy scale-x)
    (:r 255.0)
    (:g 255.0)
    (:b 255.0)
    (:a 16.0)
    (:omega (degrees 4511.25))
    (:scalevel-x (meters 0.016666668) (meters 0.0033333334))
    (:scalevel-y :copy scalevel-x)
    (:timer (seconds 0.5))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3))
    (:userdata 2048.0)
    (:next-time (seconds 0.335))
    (:next-launcher 4592)
    )
  )

(defpart 4592
  :init-specs ((:fade-a -0.32))
  )

(defpart 4590
  :init-specs ((:texture (new 'static 'texture-id :index #xbb :page #xc))
    (:num 1.0)
    (:y (meters 2))
    (:scale-x (meters 0.8) (meters 0.1))
    (:rot-x (degrees 11.25))
    (:rot-z (degrees -19) (degrees 4))
    (:scale-y :copy scale-x)
    (:r 64.0)
    (:g 255.0)
    (:b 32.0)
    (:a 32.0 4.0)
    (:omega (degrees 4511.25))
    (:timer (seconds 0.017))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3 glow))
    (:userdata 2048.0)
    )
  )

(defpart 4593
  :init-specs ((:texture (new 'static 'texture-id :index #xbb :page #xc))
    (:num 1.0)
    (:scale-x (meters 1) (meters 0.1))
    (:rot-x (degrees 2.25))
    (:rot-z (degrees -19) (degrees 4))
    (:scale-y :copy scale-x)
    (:r 255.0)
    (:g 255.0)
    (:b 64.0)
    (:a 12.0 4.0)
    (:omega (degrees 2715.75))
    (:timer (seconds 0.017))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3 glow))
    (:userdata 819.2)
    )
  )

(defpart 4594
  :init-specs ((:texture (new 'static 'texture-id :index #xbb :page #xc))
    (:num 1.0)
    (:scale-x (meters 3) (meters 0.1))
    (:rot-x (degrees 4.5))
    (:rot-z (degrees -19) (degrees 4))
    (:scale-y :copy scale-x)
    (:r 0.0)
    (:g 255.0)
    (:b 0.0)
    (:a 12.0 4.0)
    (:omega (degrees 2715.75))
    (:timer (seconds 0.017))
    (:flags (sp-cpuinfo-flag-2 sp-cpuinfo-flag-3 glow))
    (:userdata 819.2)
    )
  )

(defskelgroup skel-homing-beacon homing-beacon homing-beacon-lod0-jg homing-beacon-idle-ja
              ((homing-beacon-lod0-mg (meters 999999)))
              :bounds (static-spherem 0 1 0 3)
              )

(deftype bush-collect (process-drawable)
  ((minimap   connection-minimap  :offset-assert 200)
   (trans-y   float               :offset-assert 204)
   (beep-time float               :offset-assert 208)
   )
  :heap-base #x60
  :method-count-assert 24
  :size-assert         #xd4
  :flag-assert         #x18006000d4
  (:methods
    (idle () _type_ :state 20)
    (die () _type_ :state 21)
    (bush-collect-method-22 (_type_) none 22)
    (bush-collect-method-23 (_type_) none 23)
    )
  )


(defmethod bush-collect-method-22 bush-collect ((obj bush-collect))
  (let ((s5-0 (new 'process 'collide-shape-moving obj (collide-list-enum usually-hit-by-player))))
    (set! (-> s5-0 dynam) (copy *standard-dynamics* 'process))
    (set! (-> s5-0 reaction) cshape-reaction-default)
    (set! (-> s5-0 no-reaction)
          (the-as (function collide-shape-moving collide-query vector vector object) nothing)
          )
    (set! (-> s5-0 penetrated-by) (the-as penetrate -1))
    (let ((v1-7 (new 'process 'collide-shape-prim-sphere s5-0 (the-as uint 0))))
      (set! (-> v1-7 prim-core collide-as) (collide-spec collectable))
      (set! (-> v1-7 prim-core collide-with) (collide-spec jak vehicle-sphere hit-by-others-list player-list tobot))
      (set! (-> v1-7 transform-index) 3)
      (set-vector! (-> v1-7 local-sphere) 0.0 2048.0 0.0 16384.0)
      (set! (-> s5-0 total-prims) (the-as uint 1))
      (set! (-> s5-0 root-prim) v1-7)
      )
    (set! (-> s5-0 nav-radius) (* 0.75 (-> s5-0 root-prim local-sphere w)))
    (let ((v1-10 (-> s5-0 root-prim)))
      (set! (-> s5-0 backup-collide-as) (-> v1-10 prim-core collide-as))
      (set! (-> s5-0 backup-collide-with) (-> v1-10 prim-core collide-with))
      )
    (set! (-> obj root) s5-0)
    )
  0
  (none)
  )

(defmethod bush-collect-method-23 bush-collect ((obj bush-collect))
  0
  (none)
  )

(defstate idle (bush-collect)
  :virtual #t
  :event (behavior ((proc process) (arg1 int) (event-type symbol) (event event-message-block))
    (case event-type
      (('touch 'attack)
       (sound-play "homeing-pickup")
       (go-virtual die)
       )
      )
    )
  :enter (behavior ()
    '()
    (none)
    )
  :exit (behavior ()
    '()
    (none)
    )
  :trans (behavior ()
    (let ((f30-0 (+ (* 0.0033333334 (the float (current-time))) (* 0.1 (the float (-> self pid))))))
      (when (< (-> self beep-time) f30-0)
        (sound-play "homeing-beep")
        (set! (-> self beep-time) (+ 1.0 f30-0))
        )
      (set! (-> self root trans y) (+ (-> self trans-y) (* 4096.0 (* 0.5 (cos (* 21845.334 f30-0))))))
      (quaternion-vector-angle! (-> self root quat) *up-vector* (* 14563.556 f30-0))
      (let ((gp-1 (matrix<-transformq+world-trans!
                    (new 'stack-no-clear 'matrix)
                    (the-as transformq (-> self root trans))
                    (new 'static 'vector :y 2048.0 :w 1.0)
                    )
                  )
            )
        (when (nonzero? (-> self part))
          (spawn-with-matrix (-> self part) gp-1)
          (let ((gp-2 (vector-matrix*!
                        (new 'stack-no-clear 'vector)
                        (vector-rotate-around-y!
                          (new 'stack-no-clear 'vector)
                          (new 'static 'vector :x 1228.8 :y 2252.8 :w 1.0)
                          (* 145635.56 f30-0)
                          )
                        gp-1
                        )
                      )
                )
            (let ((t9-8 sp-launch-particles-var)
                  (a0-8 *sp-particle-system-2d*)
                  (a1-6 (-> *part-id-table* 4593))
                  (a2-5 *launch-matrix*)
                  )
              (set! (-> a2-5 trans quad) (-> gp-2 quad))
              (t9-8 a0-8 a1-6 a2-5 (the-as sparticle-launch-state #f) (the-as sparticle-launch-control #f) 1.0)
              )
            (let ((t9-9 sp-launch-particles-var)
                  (a0-9 *sp-particle-system-2d*)
                  (a1-7 (-> *part-id-table* 4594))
                  (a2-6 *launch-matrix*)
                  )
              (set! (-> a2-6 trans quad) (-> gp-2 quad))
              (t9-9 a0-9 a1-7 a2-6 (the-as sparticle-launch-state #f) (the-as sparticle-launch-control #f) 1.0)
              )
            )
          )
        )
      )
    (none)
    )
  :code (the-as (function none :behavior bush-collect) sleep-code)
  :post (behavior ()
    (ja-post)
    (none)
    )
  )

(defstate die (bush-collect)
  :virtual #t
  :code (behavior ()
    (cleanup-for-death self)
    (none)
    )
  )

;; WARN: Return type mismatch entity-perm-status vs none.
(defmethod init-from-entity! bush-collect ((obj bush-collect) (arg0 entity-actor))
  "Typically the method that does the initial setup on the process, potentially using the [[entity-actor]] provided as part of that.
This commonly includes things such as:
- stack size
- collision information
- loading the skeleton group / bones
- sounds"
  (process-entity-status! obj (entity-perm-status dead) #t)
  (none)
  )

;; WARN: Return type mismatch object vs none.
(defbehavior bush-collect-init-by-other bush-collect ((arg0 vector))
  (set! (-> self mask) (logior (process-mask bit18) (-> self mask)))
  (stack-size-set! (-> self main-thread) 16)
  (bush-collect-method-22 self)
  (set! (-> self root trans quad) (-> arg0 quad))
  (quaternion-copy! (-> self root quat) *unity-quaternion*)
  (bush-collect-method-23 self)
  (set! (-> self part) (create-launch-control (-> *part-group-id-table* 1056) self))
  (go-virtual idle)
  (none)
  )

;; WARN: Return type mismatch object vs none.
(defbehavior bush-collect-dark-eco-init-by-other bush-collect ((arg0 vector))
  (set! (-> self mask) (logior (process-mask bit18) (-> self mask)))
  (stack-size-set! (-> self main-thread) 16)
  (bush-collect-method-22 self)
  (set! (-> self root trans quad) (-> arg0 quad))
  (quaternion-copy! (-> self root quat) *unity-quaternion*)
  (bush-collect-method-23 self)
  (set! (-> self part) (create-launch-control (-> *part-group-id-table* 82) self))
  (go-virtual idle)
  (none)
  )

;; WARN: Return type mismatch object vs none.
(defbehavior bush-collect-homing-beacon-init-by-other bush-collect ((arg0 vector))
  (set! (-> self level) (level-get *level* 'lbbush))
  (set! (-> self mask) (logior (process-mask bit18) (-> self mask)))
  (stack-size-set! (-> self main-thread) 16)
  (bush-collect-method-22 self)
  (set! (-> self root trans quad) (-> arg0 quad))
  (set-vector! (-> self root scale) 2.0 2.0 2.0 1.0)
  (quaternion-copy! (-> self root quat) *unity-quaternion*)
  (bush-collect-method-23 self)
  (set! (-> self trans-y) (-> self root trans y))
  (initialize-skeleton
    self
    (the-as skeleton-group (art-group-get-by-name *level* "skel-homing-beacon" (the-as (pointer uint32) #f)))
    (the-as pair 0)
    )
  (set! (-> self part) (create-launch-control (-> *part-group-id-table* 1056) self))
  (go-virtual idle)
  (none)
  )

;; WARN: Return type mismatch (pointer process) vs (pointer bush-collect).
(defun bush-collect-spawn ((arg0 task-manager) (arg1 vector))
  (process-spawn bush-collect arg1 :to arg0)
  )

;; WARN: Return type mismatch (pointer process) vs (pointer bush-collect).
(defun bush-collect-homing-beacon-spawn ((arg0 task-manager) (arg1 vector))
  (process-spawn bush-collect :init bush-collect-homing-beacon-init-by-other arg1 :to arg0)
  )

;; WARN: Return type mismatch (pointer process) vs (pointer bush-collect).
(defun bush-collect-dark-eco-spawn ((arg0 task-manager) (arg1 vector))
  (process-spawn bush-collect :init bush-collect-dark-eco-init-by-other arg1 :to arg0)
  )

(deftype burning-bush-collection-info (structure)
  ((pos     vector             :inline :offset-assert   0)
   (handle  handle                     :offset-assert  16)
   (minimap connection-minimap         :offset-assert  24)
   )
  :method-count-assert 10
  :size-assert         #x1c
  :flag-assert         #xa0000001c
  (:methods
    (burning-bush-collection-info-method-9 (_type_ object) none 9)
    )
  )


(defmethod burning-bush-collection-info-method-9 burning-bush-collection-info ((obj burning-bush-collection-info) (arg0 object))
  (format arg0 "(static-burning-bush-collection-info~%")
  (format arg0 "     :pos (~4,,2M ~4,,2M ~4,,2M)~%)~%" (-> obj pos x) (-> obj pos y) (-> obj pos z))
  0
  (none)
  )

(deftype bb-collection-info (structure)
  ((user-data uint32                                :offset-assert   0)
   (time      time-frame                            :offset-assert   8)
   (colls     (array burning-bush-collection-info)  :offset-assert  16)
   )
  :method-count-assert 9
  :size-assert         #x14
  :flag-assert         #x900000014
  )


(define *bb-collection-info*
  (new 'static 'boxed-array :type bb-collection-info
    (new 'static 'bb-collection-info
      :user-data #x2
      :time (seconds 120)
      :colls (new 'static 'boxed-array :type burning-bush-collection-info
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 859463.7 :y 49111.04 :z 957480.94))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 856719.4 :y 49111.04 :z 1022689.25))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 786554.9 :y 49111.04 :z 1024983.06))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 714874.9 :y 49111.04 :z 1021788.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 713564.2 :y 49111.04 :z 938434.56))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1050419.2 :y 32727.04 :z 25354.24))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1188495.4 :y 32727.04 :z 34160.64))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1165312.0 :y 32768.0 :z 183787.52))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1141841.9 :y 41738.24 :z 322560.0))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1080647.6 :y 41738.24 :z 326451.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1037516.8 :y 47431.68 :z 359628.8))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1036288.0 :y 47513.6 :z 415621.12))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1083433.0 :y 47513.6 :z 470876.16))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1141719.0 :y 47513.6 :z 469401.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1182679.0 :y 41738.24 :z 564674.56))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1182105.6 :y 41738.24 :z 612229.1))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1180590.1 :y 41738.24 :z 671784.94))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1181040.6 :y 41738.24 :z 738508.8))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1180999.6 :y 41738.24 :z 799375.4))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1147084.8 :y 47308.8 :z 842096.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1108582.4 :y 47513.6 :z 839270.4))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 941260.8 :y 37560.32 :z 871137.25))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 857661.44 :y 49111.04 :z 868597.75))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 791306.25 :y 49111.04 :z 870359.06))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 719298.56 :y 49111.04 :z 874414.06))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 923566.06 :y 41738.24 :z 326983.7))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 869212.2 :y 41738.24 :z 326123.53))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 816087.06 :y 47472.64 :z 360980.47))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 817192.94 :y 47595.52 :z 423075.84))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 869130.25 :y 41738.24 :z 461168.62))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 923934.75 :y 41738.24 :z 461660.16))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 975544.3 :y 32727.04 :z 571514.9))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 864911.4 :y 49111.04 :z 685342.75))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 844226.56 :y 56442.88 :z 557096.94))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 775290.9 :y 56401.92 :z 560660.5))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 711720.94 :y 56442.88 :z 559063.06))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 491069.44 :y 47554.56 :z 529530.9))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 429056.0 :y 47595.52 :z 531415.06))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 391495.7 :y 41738.24 :z 622305.25))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 391127.03 :y 41738.24 :z 709754.9))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 426557.44 :y 47431.68 :z 841850.9))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 492339.2 :y 47267.84 :z 840089.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 390635.53 :y 41738.24 :z 947363.8))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 392110.1 :y 41738.24 :z 1002045.44))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 392192.0 :y 41738.24 :z 1055293.5))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 427991.03 :y 47513.6 :z 1109975.0))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 489431.03 :y 47513.6 :z 1108828.1))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 569917.44 :y 41738.24 :z 1179689.0))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 618168.3 :y 41738.24 :z 1180057.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 705249.25 :y 32727.04 :z 1093468.1))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 771686.4 :y 32727.04 :z 1091665.9))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 854138.9 :y 32727.04 :z 1091911.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1047756.8 :y 41738.24 :z 1057177.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1047592.94 :y 41738.24 :z 1002127.4))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1047019.5 :y 41738.24 :z 950026.25))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1083678.8 :y 47554.56 :z 901365.75))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1146224.6 :y 47595.52 :z 901529.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1183539.2 :y 41738.24 :z 415744.0))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1143234.5 :y 47595.52 :z 530145.25))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1085972.5 :y 47554.56 :z 529817.6))
        )
      )
    (new 'static 'bb-collection-info
      :time (seconds 120)
      :colls (new 'static 'boxed-array :type burning-bush-collection-info
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 691732.5 :y 45015.04 :z -1437450.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 871710.75 :y 45670.4 :z -1238425.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1036943.4 :y 46571.52 :z -1118904.4))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1275166.8 :y 11960.32 :z -1024819.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1465712.6 :y 11182.08 :z -1191649.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1366507.5 :y 69017.6 :z -1411809.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1456455.6 :y 69017.6 :z -1106370.5))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 1171660.8 :y 69017.6 :z -998727.7))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 692592.6 :y 11878.4 :z -1012572.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 457277.44 :y 11141.12 :z -1011015.7))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 222494.72 :y 69795.84 :z -1272504.4))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 54886.4 :y 44154.88 :z -1290649.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -710656.0 :y 44687.36 :z -1403945.0))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -435036.16 :y 13189.12 :z -805724.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -248176.64 :y 12083.2 :z -807444.5))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -193986.56 :y 45629.44 :z -536125.44))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -229335.05 :y 44851.2 :z -162201.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 125132.8 :y 43991.04 :z -190423.05))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 323952.62 :y 44851.2 :z -226344.95))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x 460636.16 :y 44851.2 :z -615424.0))
        )
      )
    (new 'static 'bb-collection-info
      :user-data #x1
      :time (seconds 120)
      :colls (new 'static 'boxed-array :type burning-bush-collection-info
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -330792.97 :y 32727.04 :z 371630.1))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -508354.56 :y 32727.04 :z 307732.47))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -655319.06 :y 32727.04 :z 377487.38))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -803061.75 :y 32727.04 :z 384081.9))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -993525.75 :y 32768.0 :z 355614.72))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -1122959.4 :y 34529.28 :z 395960.3))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -1239449.6 :y 43335.68 :z 485335.03))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -1460142.1 :y 44359.68 :z 482385.9))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -1555906.5 :y 55050.24 :z 245186.56))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -1204838.4 :y 33792.0 :z 216104.95))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -929832.94 :y 40099.84 :z 488529.9))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -707215.4 :y 45629.44 :z 493977.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -385269.75 :y 37355.52 :z 557301.75))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -186859.52 :y 32727.04 :z 551116.8))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -148971.52 :y 32727.04 :z 776560.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -188252.16 :y 32727.04 :z 931758.06))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -178462.72 :y 32727.04 :z 1082941.5))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -183541.77 :y 32727.04 :z 1230561.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -220323.84 :y 32727.04 :z 1405296.6))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -520888.3 :y 32727.04 :z 1353277.5))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -713482.25 :y 32727.04 :z 1093181.5))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -652206.06 :y 32727.04 :z 846848.0))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -746332.2 :y 51077.12 :z 664862.75))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -890961.94 :y 32768.0 :z 809164.8))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -971325.44 :y 32768.0 :z 766279.7))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -1154621.5 :y 34652.16 :z 780083.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -1280532.5 :y 32727.04 :z 830218.25))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -1423810.5 :y 34570.24 :z 839475.2))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -1557504.0 :y 35348.48 :z 732938.25))
        (new 'static 'burning-bush-collection-info :pos (new 'static 'vector :x -1410908.1 :y 47472.64 :z 679485.44))
        )
      )
    (new 'static 'bb-collection-info
      :time (seconds 120)
      :colls (new 'static 'boxed-array :type burning-bush-collection-info (new 'static 'burning-bush-collection-info))
      )
    )
  )

(define *city-bb-collection-edit-info* (new 'static 'array int32 512
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         0
                                         )
        )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-collection-1-resolution)
  TASK_MANAGER_CLEANUP_HOOK
  (lambda :behavior task-manager
    ()
    (let ((v1-4 (-> *bb-collection-info* (-> self info index))))
      (dotimes (a0-1 (-> v1-4 colls length))
        (when (and (-> v1-4 colls a0-1 minimap) (nonzero? (-> v1-4 colls a0-1 minimap)))
          (logior! (-> v1-4 colls a0-1 minimap flags) (minimap-flag fade-out))
          (set! (-> v1-4 colls a0-1 minimap) #f)
          )
        )
      )
    (none)
    )
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-collection-1-resolution)
  TASK_MANAGER_INIT_HOOK
  (lambda :behavior task-manager
    ()
    (set-setting! 'airlock #f 0.0 0)
    (set-setting! 'exclusive-task #f 0.0 (-> self node-info task))
    (let ((gp-0 (-> *bb-collection-info* (-> self info index))))
      (let ((v1-9 (-> gp-0 user-data)))
        (cond
          ((zero? v1-9)
           (set! (-> self hud-counter)
                 (ppointer->handle (process-spawn hud-homing-beacon :init hud-init-by-other :to *target*))
                 )
           )
          ((= v1-9 1)
           (set! (-> self hud-counter)
                 (ppointer->handle (process-spawn hud-dark-eco-pickup :init hud-init-by-other :to *target*))
                 )
           )
          ((= v1-9 2)
           (set! (-> self hud-counter)
                 (ppointer->handle (process-spawn hud-green-eco-pickup :init hud-init-by-other :to *target*))
                 )
           )
          )
        )
      (dotimes (s5-3 (-> gp-0 colls length))
        (let ((v1-32 (-> gp-0 user-data)))
          (cond
            ((zero? v1-32)
             (set! (-> gp-0 colls s5-3 handle)
                   (ppointer->handle (bush-collect-homing-beacon-spawn self (-> gp-0 colls s5-3 pos)))
                   )
             (set! (-> gp-0 colls s5-3 minimap) (add-icon!
                                                  *minimap*
                                                  (handle->process (-> gp-0 colls s5-3 handle))
                                                  (the-as uint 16)
                                                  (the-as int #f)
                                                  (the-as vector #t)
                                                  0
                                                  )
                   )
             )
            ((= v1-32 1)
             (let ((t1-3 (new 'stack 'fact-info self (pickup-type eco-pill-random) (-> *FACT-bank* default-eco-pill-green-inc)))
                   )
               (new 'stack-no-clear 'vector)
               (set! (-> t1-3 options) (logior (actor-option fade-out no-distance-check-fadeout) (-> t1-3 options)))
               (set! (-> t1-3 fade-time) (-> gp-0 time))
               (set! (-> gp-0 colls s5-3 handle)
                     (ppointer->handle
                       (birth-pickup-at-point (-> gp-0 colls s5-3 pos) (pickup-type eco-pill-dark) 1.0 #t self t1-3)
                       )
                     )
               )
             (set! (-> gp-0 colls s5-3 minimap) (add-icon!
                                                  *minimap*
                                                  (handle->process (-> gp-0 colls s5-3 handle))
                                                  (the-as uint 16)
                                                  (the-as int #f)
                                                  (the-as vector #t)
                                                  0
                                                  )
                   )
             )
            ((= v1-32 2)
             (let ((t1-5 (new 'stack 'fact-info self (pickup-type eco-pill-random) (-> *FACT-bank* default-eco-pill-green-inc)))
                   )
               (new 'stack-no-clear 'vector)
               (set! (-> t1-5 options) (logior (actor-option fade-out no-distance-check-fadeout) (-> t1-5 options)))
               (set! (-> t1-5 fade-time) (-> gp-0 time))
               (set! (-> gp-0 colls s5-3 handle)
                     (ppointer->handle
                       (birth-pickup-at-point (-> gp-0 colls s5-3 pos) (pickup-type eco-pill-green) 1.0 #t self t1-5)
                       )
                     )
               )
             (set! (-> gp-0 colls s5-3 minimap) (add-icon!
                                                  *minimap*
                                                  (handle->process (-> gp-0 colls s5-3 handle))
                                                  (the-as uint 16)
                                                  (the-as int #f)
                                                  (the-as vector #t)
                                                  0
                                                  )
                   )
             )
            (else
              (set! (-> gp-0 colls s5-3 handle) (ppointer->handle (bush-collect-spawn self (-> gp-0 colls s5-3 pos))))
              (set! (-> gp-0 colls s5-3 minimap) #f)
              )
            )
          )
        )
      (set! (-> self start-time) (current-time))
      (set! (-> self time-limit) (-> gp-0 time))
      )
    (none)
    )
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-collection-1-resolution)
  TASK_MANAGER_UPDATE_HOOK
  (lambda :behavior task-manager
    ()
    (check-time self)
    (let ((a0-2 (-> *bb-collection-info* (-> self info index)))
          (v1-6 0)
          )
      (dotimes (a1-0 (-> a0-2 colls length))
        (cond
          ((and (nonzero? (-> a0-2 colls a1-0 handle)) (handle->process (-> a0-2 colls a1-0 handle)))
           (+! v1-6 1)
           )
          (else
            (when (-> a0-2 colls a1-0 minimap)
              (logior! (-> a0-2 colls a1-0 minimap flags) (minimap-flag fade-out))
              (set! (-> a0-2 colls a1-0 minimap) #f)
              )
            )
          )
        )
      (set! (-> *game-info* counter) (the float v1-6))
      (if (zero? v1-6)
          (go-virtual complete)
          )
      )
    (none)
    )
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-collection-1-resolution)
  TASK_MANAGER_CODE_HOOK
  (lambda :behavior task-manager () (set! (-> self state-time) (current-time)) (none))
  )

;; PC PORT NOTE : added complete hook for collection bbush tasks where we wait for the hud to die first
(set-subtask-hook! *game-info* (game-task-node city-burning-bush-collection-1-resolution)
  TASK_MANAGER_COMPLETE_HOOK
  (lambda :behavior task-manager ()
    (while (handle->process (-> self hud-counter))
      (suspend))))

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-collection-2-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-collection-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-collection-3-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-collection-1-resolution))
  )

(deftype burning-bush-get-on-info (structure)
  ((trans        vector     :inline :offset-assert   0)
   (quat         quaternion :inline :offset-assert  16)
   (camera-trans vector     :inline :offset-assert  32)
   (camera-rot   float      9       :offset-assert  48)
   (time         float              :offset-assert  84)
   )
  :method-count-assert 9
  :size-assert         #x58
  :flag-assert         #x900000058
  )


(define *burning-bush-get-on-info*
  (new 'static 'boxed-array :type burning-bush-get-on-info
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x -1530670.2 :y 32765.543 :z 2502434.0 :w 1.0)
      :quat (new 'static 'quaternion :y -0.6321 :w 0.7748)
      :camera-trans (new 'static 'vector :x -1503602.2 :y 62047.027 :z 2475579.5 :w 1.0)
      :camera-rot (new 'static 'array float 9 0.689 0.0 0.7247 -0.3328 0.8882 0.3164 -0.6437 -0.4592 0.612)
      :time 6000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 4318766.0 :y 2145.8943 :z 808666.3 :w 1.0)
      :quat (new 'static 'quaternion :y -0.9999 :w -0.0115)
      :camera-trans (new 'static 'vector :x 4387209.0 :y 39837.285 :z 818740.44 :w 1.0)
      :camera-rot (new 'static 'array float 9 -0.1641 0.0 0.9864 -0.4679 0.8803 -0.0778 -0.8683 -0.4744 -0.1444)
      :time 6000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 3322434.0 :y 99432.445 :z 3684668.2 :w 1.0)
      :quat (new 'static 'quaternion :y -0.9923 :w 0.1235)
      :camera-trans (new 'static 'vector :x 3332904.2 :y 134062.48 :z 3737897.0 :w 1.0)
      :camera-rot (new 'static 'array float 9 -0.9774 0.0 0.2113 -0.0762 0.9325 -0.3528 -0.197 -0.361 -0.9114)
      :time 6000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 663325.5 :y 17938.842 :z 4885086.0 :w 1.0)
      :quat (new 'static 'quaternion :y -0.4768 :w -0.879)
      :camera-trans (new 'static 'vector :x 730486.4 :y 66763.164 :z 4933765.0 :w 1.0)
      :camera-rot (new 'static 'array float 9 -0.5022 0.0 0.8647 -0.3772 0.8998 -0.2191 -0.7781 -0.4362 -0.4518)
      :time 10500.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 570983.6 :y 94438.6 :z 4240269.0 :w 1.0)
      :quat (new 'static 'quaternion :y 0.9299 :w -0.3677)
      :camera-trans (new 'static 'vector :x 493339.44 :y 129311.945 :z 4223747.0 :w 1.0)
      :camera-rot (new 'static 'array float 9 0.1785 0.0 -0.9839 0.4944 0.8645 0.0897 0.8506 -0.5025 0.1543)
      :time 12000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x -168806.81 :y 48443.8 :z 3844239.8 :w 1.0)
      :quat (new 'static 'quaternion :y 0.9837 :w 0.1795)
      :camera-trans (new 'static 'vector :x -151019.92 :y 94520.12 :z 3768899.2 :w 1.0)
      :camera-rot (new 'static 'array float 9 0.9513 0.0 0.3082 -0.1497 0.874 0.4621 -0.2694 -0.4858 0.8314)
      :time 9000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x -622166.8 :y 38157.105 :z 788430.44 :w 1.0)
      :quat (new 'static 'quaternion :y 0.9294 :w -0.3688)
      :camera-trans (new 'static 'vector :x -655421.44 :y 38743.246 :z 755565.4 :w 1.0)
      :camera-rot (new 'static 'array float 9 0.7391 0.0 -0.6735 -0.1633 0.9701 -0.1792 0.6534 0.2424 0.717)
      :time 6000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x -981622.4 :y 32762.266 :z -1378460.9 :w 1.0)
      :quat (new 'static 'quaternion :y -0.9881 :w -0.1537)
      :camera-trans (new 'static 'vector :x -1001924.2 :y 76537.445 :z -1419026.9 :w 1.0)
      :camera-rot (new 'static 'array float 9 0.8637 0.0 -0.5039 0.2989 0.8051 0.5122 0.4057 -0.5931 0.6953)
      :time 6000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 1437632.9 :y 41757.082 :z -1262564.5 :w 1.0)
      :quat (new 'static 'quaternion :y 0.409 :w -0.9125)
      :camera-trans (new 'static 'vector :x 1451820.2 :y 44497.305 :z -1328512.2 :w 1.0)
      :camera-rot (new 'static 'array float 9 0.9983 0.0 0.0578 0.0045 0.9969 -0.0777 -0.0576 0.0778 0.9952)
      :time 6000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 783885.1 :y 40796.16 :z -705780.5 :w 1.0)
      :quat (new 'static 'quaternion :y -0.6938 :w 0.7201)
      :camera-trans (new 'static 'vector :x 741225.7 :y 46757.887 :z -776107.2 :w 1.0)
      :camera-rot (new 'static 'array float 9 0.9057 0.0 -0.4238 -0.0939 0.9751 -0.2007 0.4132 0.2216 0.8832)
      :time 6000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 2180319.2 :y -443.1872 :z -2409681.2 :w 1.0)
      :quat (new 'static 'quaternion :y -0.8512 :w 0.5248)
      :camera-trans (new 'static 'vector :x 2186967.0 :y 4454.8096 :z -2441144.2 :w 1.0)
      :camera-rot (new 'static 'array float 9 0.9628 0.0 0.2698 0.02 0.9972 -0.0715 -0.2691 0.0743 0.9602)
      :time 6000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 609418.06 :y 32768.0 :z -1476082.9 :w 1.0)
      :quat (new 'static 'quaternion :y -0.9919 :w 0.1265)
      :camera-trans (new 'static 'vector :x 600542.8 :y 37365.35 :z -1515416.8 :w 1.0)
      :camera-rot (new 'static 'array float 9 0.9811 0.0 -0.1932 -0.0172 0.996 -0.0875 0.1924 0.0892 0.9772)
      :time 9000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 2543148.8 :y 37827.38 :z 3158161.5 :w 1.0)
      :quat (new 'static 'quaternion :y -0.9581 :w 0.2863)
      :camera-trans (new 'static 'vector :x 2513162.2 :y 68558.03 :z 3066508.5 :w 1.0)
      :camera-rot (new 'static 'array float 9 0.9036 0.0 -0.4281 0.1063 0.9686 0.2244 0.4147 -0.2483 0.8753)
      :time 9000.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 1663103.0 :y 34921.266 :z 2111440.0 :w 1.0)
      :quat (new 'static 'quaternion :y 0.562 :w 0.8271)
      :camera-trans (new 'static 'vector :x 1741256.8 :y 131765.86 :z 2247819.8 :w 1.0)
      :camera-rot (new 'static 'array float 9 -0.9324 0.0 0.3611 -0.1247 0.9384 -0.322 -0.3389 -0.3453 -0.8751)
      :time 7500.0
      )
    (new 'static 'burning-bush-get-on-info
      :trans (new 'static 'vector :x 4012071.2 :y 102169.805 :z 3209066.5 :w 1.0)
      :quat (new 'static 'quaternion :y 0.6466 :w 0.7627)
      :camera-trans (new 'static 'vector :x 4028088.8 :y 103657.47 :z 3221753.8 :w 1.0)
      :camera-rot (new 'static 'array float 9 -0.449 0.0 0.8934 0.2339 0.9651 0.1175 -0.8623 0.2617 -0.4334)
      :time 7500.0
      )
    )
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-get-to-1-resolution)
  TASK_MANAGER_INIT_HOOK
  (lambda :behavior task-manager
    ()
    (set-setting! 'airlock #f 0.0 0)
    (set-setting! 'exclusive-task #f 0.0 (-> self node-info task))
    (none)
    )
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-get-to-1-resolution)
  TASK_MANAGER_UPDATE_HOOK
  (lambda :behavior task-manager () (none))
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-get-to-1-resolution)
  TASK_MANAGER_CLEANUP_HOOK
  (lambda :behavior task-manager
    ()
    (let ((a0-1 (handle->process (-> self slave 0))))
      (if a0-1
          (deactivate a0-1)
          )
      )
    (none)
    )
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-get-to-1-resolution)
  TASK_MANAGER_COMPLETE_HOOK
  (lambda :behavior task-manager () (close! (-> self node-info) 'event) (none))
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-get-to-1-resolution)
  TASK_MANAGER_FAIL_HOOK
  (lambda :behavior task-manager
    ()
    (if (and *target* (focus-test? *target* grabbed))
        (process-release? *target*)
        )
    (none)
    )
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-get-to-1-resolution)
  TASK_MANAGER_CODE_HOOK
  (lambda :behavior task-manager
    ()
    (set-setting! 'minimap 'clear 0.0 (minimap-flag minimap))
    (while (not (process-grab? *target* #f))
      (suspend)
      )
    (let ((t1-1 (new 'stack 'fact-info self (pickup-type eco-pill-random) (-> *FACT-bank* default-eco-pill-green-inc)))
          (a0-3 (new 'stack-no-clear 'vector))
          )
      (logior! (-> t1-1 options) (actor-option fade-out))
      (set! (-> t1-1 fade-time)
            (the-as time-frame (the int (-> *burning-bush-get-on-info* (-> self info index) time)))
            )
      (set! (-> a0-3 quad) (-> *burning-bush-get-on-info* (-> self info index) trans quad))
      (set! (-> a0-3 y) (+ 4096.0 (-> a0-3 y)))
      (set! (-> self slave 0)
            (ppointer->handle
              (birth-pickup-at-point a0-3 (pickup-type skill) (-> *FACT-bank* super-skill-inc) #t self t1-1)
              )
            )
      )
    (set! (-> self start-time) (current-time))
    (set! (-> self time-limit)
          (the-as time-frame (the int (+ 300.0 (-> *burning-bush-get-on-info* (-> self info index) time))))
          )
    (suspend)
    (send-event (handle->process (-> self slave 0)) 'get-notify self)
    (set-setting! 'interp-time 'abs 0.0 0)
    (set-setting! 'mode-name 'cam-fixed 0.0 0)
    (set! (-> *ACTOR-bank* birth-max) 1000)
    (suspend)
    (let ((gp-0 (new 'stack 'transformq)))
      (let ((v1-45 (-> *burning-bush-get-on-info* (-> self info index)))
            (a1-16 (new 'stack-no-clear 'matrix))
            )
        (set! (-> gp-0 trans quad) (-> v1-45 camera-trans quad))
        (set-vector! (-> gp-0 scale) 1.0 1.0 1.0 1.0)
        (set! (-> a1-16 vector 0 x) (-> v1-45 camera-rot 0))
        (set! (-> a1-16 vector 0 y) (-> v1-45 camera-rot 1))
        (set! (-> a1-16 vector 0 z) (-> v1-45 camera-rot 2))
        (set! (-> a1-16 vector 0 w) 0.0)
        (set! (-> a1-16 vector 1 x) (-> v1-45 camera-rot 3))
        (set! (-> a1-16 vector 1 y) (-> v1-45 camera-rot 4))
        (set! (-> a1-16 vector 1 z) (-> v1-45 camera-rot 5))
        (set! (-> a1-16 vector 1 w) 0.0)
        (set! (-> a1-16 vector 2 x) (-> v1-45 camera-rot 6))
        (set! (-> a1-16 vector 2 y) (-> v1-45 camera-rot 7))
        (set! (-> a1-16 vector 2 z) (-> v1-45 camera-rot 8))
        (set! (-> a1-16 vector 2 w) 0.0)
        (set! (-> a1-16 trans x) 0.0)
        (set! (-> a1-16 trans y) 0.0)
        (set! (-> a1-16 trans z) 0.0)
        (set! (-> a1-16 trans w) 1.0)
        (matrix->quaternion (-> gp-0 quat) a1-16)
        )
      (send-event *camera* 'teleport-to-transformq gp-0)
      )
    (let ((gp-1 (current-time)))
      (until (>= (- (current-time) gp-1) (seconds 3))
        (suspend)
        )
      )
    (remove-setting! 'minimap)
    (set! (-> *ACTOR-bank* birth-max) 1000)
    (persist-with-delay *setting-control* 'interp-time (seconds 0.05) 'interp-time 'abs 0.0 0)
    (remove-setting! 'interp-time)
    (remove-setting! 'mode-name)
    (while (not (process-release? *target*))
      (suspend)
      )
    (until #f
      (check-time self)
      (suspend)
      )
    #f
    )
  )

(set-subtask-hook!
  *game-info*
  (game-task-node city-burning-bush-get-to-1-resolution)
  TASK_MANAGER_EVENT_HOOK
  (lambda :behavior task-manager
    ((arg0 process) (arg1 int) (arg2 symbol) (arg3 event-message-block))
    (case arg2
      (('notify)
       (case (-> arg3 param 0)
         (('pickup)
          (go-virtual complete)
          )
         (('die)
          (go-virtual fail)
          )
         )
       )
      )
    (none)
    )
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-2-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-3-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-4-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-5-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-6-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-7-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-8-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-9-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-10-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-11-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-12-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-13-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-14-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(copy-hooks!
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-15-resolution))
  (-> *game-info* sub-task-list (game-task-node city-burning-bush-get-to-1-resolution))
  )

(defmethod draw hud-homing-beacon ((obj hud-homing-beacon))
  (set-hud-piece-position!
    (the-as hud-sprite (-> obj sprites))
    (the int (+ 457.0 (* 130.0 (-> obj offset))))
    160
    )
  (set! (-> obj sprites 0 scale-x) 1.0)
  (set! (-> obj sprites 0 scale-y) 1.0)
  (set! (-> obj sprites 0 flags) (the-as uint 4))
  (set! (-> obj strings 0 scale) 0.5)
  (set! (-> obj strings 0 flags) (font-flags kerning middle large))
  (format (clear (-> obj strings 0 text)) "~D" (-> obj values 0 current))
  (set-as-offset-from! (the-as hud-sprite (-> obj strings 0 pos)) (the-as vector4w (-> obj sprites)) -16 60)
  ((method-of-type hud draw) obj)
  0
  (none)
  )

(defmethod update-values hud-homing-beacon ((obj hud-homing-beacon))
  (set! (-> obj values 0 target) (the int (-> *game-info* counter)))
  ((method-of-type hud update-values) obj)
  0
  (none)
  )

(defmethod init-callback hud-homing-beacon ((obj hud-homing-beacon))
  (set! (-> obj level) (level-get *level* 'lbbush))
  (set! (-> obj gui-id)
        (add-process *gui-control* obj (gui-channel hud-middle-right) (gui-action hidden) (-> obj name) 81920.0 0)
        )
  (logior! (-> obj flags) (hud-flags show))
  (set! (-> obj sprites 0 tex) (lookup-texture-by-id (new 'static 'texture-id :page #xd89)))
  (alloc-string-if-needed obj 0)
  0
  (none)
  )

(defmethod draw hud-dark-eco-pickup ((obj hud-dark-eco-pickup))
  (set-hud-piece-position!
    (the-as hud-sprite (-> obj sprites))
    (the int (+ 457.0 (* 130.0 (-> obj offset))))
    180
    )
  (set! (-> obj sprites 0 scale-x) 1.0)
  (set! (-> obj sprites 0 scale-y) 1.0)
  (set! (-> obj sprites 0 flags) (the-as uint 4))
  (set! (-> obj strings 0 flags) (font-flags kerning middle large))
  (set! (-> obj strings 0 scale) 0.5)
  (format (clear (-> obj strings 0 text)) "~D" (-> obj values 0 current))
  (set-as-offset-from! (the-as hud-sprite (-> obj strings 0 pos)) (the-as vector4w (-> obj sprites)) -16 26)
  ((method-of-type hud draw) obj)
  0
  (none)
  )

(defmethod update-values hud-dark-eco-pickup ((obj hud-dark-eco-pickup))
  (set! (-> obj values 0 target) (the int (-> *game-info* counter)))
  ((method-of-type hud update-values) obj)
  0
  (none)
  )

(defmethod init-callback hud-dark-eco-pickup ((obj hud-dark-eco-pickup))
  (set! (-> obj gui-id)
        (add-process *gui-control* obj (gui-channel hud-middle-right) (gui-action hidden) (-> obj name) 81920.0 0)
        )
  (logior! (-> obj flags) (hud-flags show))
  (set! (-> obj sprites 0 tex) (lookup-texture-by-id (new 'static 'texture-id :index #x46 :page #x67a)))
  (alloc-string-if-needed obj 0)
  0
  (none)
  )

(defmethod draw hud-green-eco-pickup ((obj hud-green-eco-pickup))
  (set-hud-piece-position!
    (the-as hud-sprite (-> obj sprites))
    (the int (+ 457.0 (* 130.0 (-> obj offset))))
    180
    )
  (set! (-> obj sprites 0 scale-x) 1.0)
  (set! (-> obj sprites 0 scale-y) 1.0)
  (set! (-> obj sprites 0 flags) (the-as uint 4))
  (set! (-> obj strings 0 flags) (font-flags kerning middle large))
  (set! (-> obj strings 0 scale) 0.5)
  (format (clear (-> obj strings 0 text)) "~D" (-> obj values 0 current))
  (set-as-offset-from! (the-as hud-sprite (-> obj strings 0 pos)) (the-as vector4w (-> obj sprites)) -16 26)
  ((method-of-type hud draw) obj)
  0
  (none)
  )

(defmethod update-values hud-green-eco-pickup ((obj hud-green-eco-pickup))
  (set! (-> obj values 0 target) (the int (-> *game-info* counter)))
  ((method-of-type hud update-values) obj)
  0
  (none)
  )

(defmethod init-callback hud-green-eco-pickup ((obj hud-green-eco-pickup))
  (set! (-> obj gui-id)
        (add-process *gui-control* obj (gui-channel hud-middle-right) (gui-action hidden) (-> obj name) 81920.0 0)
        )
  (logior! (-> obj flags) (hud-flags show))
  (set! (-> obj sprites 0 tex) (lookup-texture-by-id (new 'static 'texture-id :index #x47 :page #x67a)))
  (alloc-string-if-needed obj 0)
  0
  (none)
  )
