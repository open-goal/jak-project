name: Build

on:
  push:
    branches:
      - master
  pull_request:
    branches:
      - master
  merge_group: {}

jobs:
  # Windows
  build_windows_clang:
    name: "üñ•Ô∏è Windows"
    uses: ./.github/workflows/windows-build-clang.yaml
    with:
      cmakePreset: "Release-windows-clang"
      cachePrefix: ""
    secrets: inherit

  build_windows_msvc:
    name: "üñ•Ô∏è Windows"
    uses: ./.github/workflows/windows-build-msvc.yaml
    with:
      cmakePreset: "Release-windows-msvc"
      cachePrefix: ""
    secrets: inherit

  # Linux
  build_linux_clang:
    name: "üêß Linux"
    uses: ./.github/workflows/linux-build-clang.yaml
    with:
      cmakePreset: "Release-linux-clang-asan"
      cachePrefix: ""
    secrets: inherit

  build_linux_gcc:
    name: "üêß Linux"
    uses: ./.github/workflows/linux-build-gcc.yaml
    with:
      cmakePreset: "Release-linux-gcc"
      cachePrefix: ""
    secrets: inherit

  # MacOS
  build_macos_intel:
    name: "üçé MacOS"
    uses: ./.github/workflows/macos-build.yaml
    with:
      cmakePreset: "Release-macos-clang"
      cachePrefix: ""

  # There are ARM64 macOS runners, but they aren't free _yet_
  # limited to the large runners right now
  build_macos_arm:
    name: "üçé MacOS"
    uses: ./.github/workflows/macos-build-arm.yaml
    with:
      cmakePreset: "Release-macos-arm64-clang"
      cachePrefix: ""
