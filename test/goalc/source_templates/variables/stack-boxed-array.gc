(deftype test-stack-array-basic (basic)
  ((a uint32)
   (b uint32)
   )
  )

(let ((x (new 'stack 'boxed-array uint32 2))
      (y (new 'stack 'boxed-array test-stack-array-basic 2))
      (z (new 'stack 'boxed-array uint64 2))
      (a (new 'stack 'test-stack-array-basic))
      (b (new 'stack 'test-stack-array-basic)))
  (set! (-> x 0) 1)
  (set! (-> x 1) 2)
  (set! (-> a a) 3)
  (set! (-> a b) 4)
  (set! (-> b a) 5)
  (set! (-> b b) 6)
  (set! (-> y 0) a)
  (set! (-> y 1) b)
  (set! (-> z 0) 7)
  (set! (-> z 1) 8)
  ;; 36
  (+ (-> x 0) (-> x 1)
     (-> y 0 a) (-> y 0 b) (-> y 1 a) (-> y 1 b)
     (-> z 0) (-> z 1))
  )
