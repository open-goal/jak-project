;;-*-Lisp-*-
(in-package goal)

;; definition of type billboard
(deftype billboard (drawable)
  ((flat  adgif-shader  :inline)
   )
  )

;; definition for method 3 of type billboard
(defmethod inspect ((this billboard))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this (-> this type))
  (format #t "~1Tid: ~D~%" (-> this id))
  (format #t "~1Tbsphere: ~`vector`P~%" (-> this bsphere))
  (format #t "~1Tflat: #<adgif-shader @ #x~X>~%" (-> this flat))
  (label cfg-4)
  this
  )

;; definition of type shrub-view-data
(deftype shrub-view-data (structure)
  ((data            uint128     3)
   (texture-giftag  gs-gif-tag  :inline :overlay-at (-> data 0))
   (consts          vector      :inline :overlay-at (-> data 1))
   (fog-clamp       vector      :inline :overlay-at (-> data 2))
   (tex-start-ptr   int32               :overlay-at (-> data 1))
   (gifbufsum       float               :overlay-at (-> data 1))
   (mtx-buf-ptr     int32               :overlay-at (-> consts y))
   (exp23           float               :overlay-at mtx-buf-ptr)
   (fog-0           float               :overlay-at (-> consts z))
   (fog-1           float               :overlay-at (-> consts w))
   (fog-min         float               :overlay-at (-> data 2))
   (fog-max         float               :overlay-at (-> fog-clamp y))
   )
  )

;; definition for method 3 of type shrub-view-data
(defmethod inspect ((this shrub-view-data))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this 'shrub-view-data)
  (format #t "~1Tdata[3] @ #x~X~%" (-> this data))
  (format #t "~1Ttexture-giftag: #<qword @ #x~X>~%" (-> this data))
  (format #t "~1Tconsts: #<vector @ #x~X>~%" (&-> this tex-start-ptr))
  (format #t "~1Tfog-clamp: #<vector @ #x~X>~%" (-> this fog-clamp))
  (format #t "~1Ttex-start-ptr: ~D~%" (-> this tex-start-ptr))
  (format #t "~1Tgifbufsum: ~f~%" (-> this gifbufsum))
  (format #t "~1Tmtx-buf-ptr: ~D~%" (-> this mtx-buf-ptr))
  (format #t "~1Texp23: ~f~%" (-> this exp23))
  (format #t "~1Tfog-0: ~f~%" (-> this fog-0))
  (format #t "~1Tfog-1: ~f~%" (-> this fog-1))
  (format #t "~1Tfog-min: ~f~%" (-> this fog-clamp x))
  (format #t "~1Tfog-max: ~f~%" (-> this fog-clamp y))
  (label cfg-4)
  this
  )

;; definition of type shrubbery
(deftype shrubbery (drawable)
  ((textures  (inline-array adgif-shader)  :overlay-at id)
   (header    qword                        :offset   8)
   (obj-qwc   uint8                        :offset  12)
   (vtx-qwc   uint8                        :offset  13)
   (col-qwc   uint8                        :offset  14)
   (stq-qwc   uint8                        :offset  15)
   (obj       uint32                       :overlay-at (-> bsphere data 0))
   (vtx       uint32                       :overlay-at (-> bsphere data 1))
   (col       uint32                       :overlay-at (-> bsphere data 2))
   (stq       uint32                       :overlay-at (-> bsphere data 3))
   )
  )

;; definition for method 3 of type shrubbery
(defmethod inspect ((this shrubbery))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this (-> this type))
  (format #t "~1Tid: ~D~%" (-> this id))
  (format #t "~1Tbsphere: ~`vector`P~%" (&-> this obj))
  (format #t "~1Ttextures: #x~X~%" (-> this textures))
  (format #t "~1Theader: #<qword @ #x~X>~%" (-> this header))
  (format #t "~1Tobj-qwc: ~D~%" (-> this obj-qwc))
  (format #t "~1Tvtx-qwc: ~D~%" (-> this vtx-qwc))
  (format #t "~1Tcol-qwc: ~D~%" (-> this col-qwc))
  (format #t "~1Tstq-qwc: ~D~%" (-> this stq-qwc))
  (format #t "~1Tobj: #x~X~%" (-> this obj))
  (format #t "~1Tvtx: #x~X~%" (-> this vtx))
  (format #t "~1Tcol: #x~X~%" (-> this col))
  (format #t "~1Tstq: #x~X~%" (-> this stq))
  (label cfg-4)
  this
  )

;; definition of type instance-shrubbery
(deftype instance-shrubbery (instance)
  ((flat-normal  vector  :inline)
   (flat-hwidth  float   :overlay-at (-> flat-normal data 3))
   (color        uint32  :offset   8)
   )
  )

;; definition for method 3 of type instance-shrubbery
(defmethod inspect ((this instance-shrubbery))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this (-> this type))
  (format #t "~1Tid: ~D~%" (-> this id))
  (format #t "~1Tbsphere: ~`vector`P~%" (-> this bsphere))
  (format #t "~1Tbucket-index: ~D~%" (-> this bucket-index))
  (format #t "~1Torigin: #<matrix4h @ #x~X>~%" (-> this origin))
  (format #t "~1Tflags: ~D~%" (-> this flags))
  (format #t "~1Twind-index: ~D~%" (-> this wind-index))
  (format #t "~1Tflat-normal: #<vector @ #x~X>~%" (-> this flat-normal))
  (format #t "~1Tflat-hwidth: ~f~%" (-> this flat-normal w))
  (format #t "~1Tcolor: ~D~%" (-> this color))
  (label cfg-4)
  this
  )

;; definition of type drawable-inline-array-instance-shrub
(deftype drawable-inline-array-instance-shrub (drawable-inline-array)
  ((data  instance-shrubbery  1 :inline)
   (pad   uint32)
   )
  )

;; definition of type drawable-tree-instance-shrub
(deftype drawable-tree-instance-shrub (drawable-tree)
  ((info          prototype-array-shrub-info  :offset   8)
   (colors-added  time-of-day-palette         :offset  12)
   )
  )

;; definition of type generic-shrub-fragment
(deftype generic-shrub-fragment (drawable)
  ((textures  (inline-array adgif-shader)  :overlay-at id)
   (vtx-cnt   uint32                       :offset   8)
   (cnt-qwc   uint8                        :offset  12)
   (vtx-qwc   uint8                        :offset  13)
   (col-qwc   uint8                        :offset  14)
   (stq-qwc   uint8                        :offset  15)
   (cnt       uint32                       :overlay-at (-> bsphere data 0))
   (vtx       uint32                       :overlay-at (-> bsphere data 1))
   (col       uint32                       :overlay-at (-> bsphere data 2))
   (stq       uint32                       :overlay-at (-> bsphere data 3))
   )
  )

;; definition for method 3 of type generic-shrub-fragment
(defmethod inspect ((this generic-shrub-fragment))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this (-> this type))
  (format #t "~1Tid: ~D~%" (-> this id))
  (format #t "~1Tbsphere: ~`vector`P~%" (-> this bsphere))
  (format #t "~1Ttextures: #x~X~%" (-> this textures))
  (format #t "~1Tvtx-cnt: ~D~%" (-> this vtx-cnt))
  (format #t "~1Tcnt-qwc: ~D~%" (-> this cnt-qwc))
  (format #t "~1Tvtx-qwc: ~D~%" (-> this vtx-qwc))
  (format #t "~1Tcol-qwc: ~D~%" (-> this col-qwc))
  (format #t "~1Tstq-qwc: ~D~%" (-> this stq-qwc))
  (format #t "~1Tcnt: #x~X~%" (-> this bsphere x))
  (format #t "~1Tvtx: #x~X~%" (-> this bsphere y))
  (format #t "~1Tcol: #x~X~%" (-> this bsphere z))
  (format #t "~1Tstq: #x~X~%" (-> this bsphere w))
  (label cfg-4)
  this
  )

;; definition of type prototype-shrubbery
(deftype prototype-shrubbery (drawable-inline-array)
  ((data  shrubbery  1 :inline)
   (pad   uint32)
   )
  )

;; definition of type prototype-trans-shrubbery
(deftype prototype-trans-shrubbery (prototype-shrubbery)
  ()
  )

;; definition of type prototype-generic-shrub
(deftype prototype-generic-shrub (drawable-group)
  ()
  )

;; definition of type shrubbery-matrix
(deftype shrubbery-matrix (structure)
  ((mat    matrix  :inline)
   (color  qword   :inline)
   )
  )

;; definition for method 3 of type shrubbery-matrix
(defmethod inspect ((this shrubbery-matrix))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this 'shrubbery-matrix)
  (format #t "~1Tmat: #<matrix @ #x~X>~%" (-> this mat))
  (format #t "~1Tcolor: #<qword @ #x~X>~%" (-> this color))
  (label cfg-4)
  this
  )

;; definition for function shrubbery-login-post-texture
;; INFO: Used lq/sq
;; WARN: Return type mismatch symbol vs none.
(defun shrubbery-login-post-texture ((arg0 shrubbery))
  (let* ((v1-1 (-> arg0 header data 0))
         (a1-1 (the-as object (+ (the-as uint (-> arg0 header)) (* (+ (-> arg0 header data 1) 1) 16))))
         (a2-5 (the-as object (+ (the-as int a1-1) (* v1-1 64))))
         (a3-0 (the-as object (-> arg0 textures)))
         )
    (dotimes (a0-1 (the-as int v1-1))
      (set! (-> (the-as qword a2-5) quad) (-> (the-as qword a3-0) quad))
      (let ((a2-6 (the-as object (+ (the-as int a2-5) 16)))
            (a3-1 (the-as object (&+ (the-as pointer a3-0) 16)))
            )
        (set! (-> (the-as qword a1-1) vector4w x) (the-as int (-> (the-as qword a3-1) data 0)))
        (set! (-> (the-as qword a1-1) vector4w y) (the-as int (-> (the-as qword a3-1) data 1)))
        (set! (-> (the-as qword a1-1) vector4w z) (the-as int (-> (the-as qword a3-1) data 2)))
        (set! a1-1 (+ (the-as int a1-1) 16))
        (let ((a3-2 (the-as object (&+ (the-as pointer a3-1) 16))))
          (dotimes (t0-4 3)
            (set! (-> (the-as qword a1-1) quad) (-> (the-as qword a3-2) quad))
            (set! a1-1 (+ (the-as int a1-1) 16))
            (set! a3-2 (&+ (the-as pointer a3-2) 16))
            )
          (set! (-> (the-as qword a2-6) quad) (-> (the-as qword a3-2) quad))
          (set! a2-5 (+ (the-as int a2-6) 16))
          (set! a3-0 (&+ (the-as pointer a3-2) 80))
          )
        )
      )
    )
  (none)
  )

;; definition for symbol *shrub-state*, type int
(define *shrub-state* 0)

;; definition of type shrub-near-packet
(deftype shrub-near-packet (structure)
  ((matrix-tmpl  dma-packet  :inline)
   (header-tmpl  dma-packet  :inline)
   (stq-tmpl     dma-packet  :inline)
   (color-tmpl   dma-packet  :inline)
   (vertex-tmpl  dma-packet  :inline)
   (mscal-tmpl   dma-packet  :inline)
   (init-tmpl    dma-packet  :inline)
   (init-data    qword       2 :inline)
   )
  )

;; definition for method 3 of type shrub-near-packet
(defmethod inspect ((this shrub-near-packet))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this 'shrub-near-packet)
  (format #t "~1Tmatrix-tmpl: #<dma-packet @ #x~X>~%" (-> this matrix-tmpl))
  (format #t "~1Theader-tmpl: #<dma-packet @ #x~X>~%" (-> this header-tmpl))
  (format #t "~1Tstq-tmpl: #<dma-packet @ #x~X>~%" (-> this stq-tmpl))
  (format #t "~1Tcolor-tmpl: #<dma-packet @ #x~X>~%" (-> this color-tmpl))
  (format #t "~1Tvertex-tmpl: #<dma-packet @ #x~X>~%" (-> this vertex-tmpl))
  (format #t "~1Tmscal-tmpl: #<dma-packet @ #x~X>~%" (-> this mscal-tmpl))
  (format #t "~1Tinit-tmpl: #<dma-packet @ #x~X>~%" (-> this init-tmpl))
  (format #t "~1Tinit-data[8] @ #x~X~%" (-> this init-data))
  (label cfg-4)
  this
  )

;; definition of type instance-shrub-work
(deftype instance-shrub-work (structure)
  ((dummy                            qword              3 :inline)
   (chaina                           qword              8 :inline)
   (chainb                           qword              8 :inline)
   (colors                           rgba               1024)
   (matrix-tmpl                      qword              20 :inline)
   (count-tmpl                       vector4w           20 :inline)
   (mscalf-tmpl                      dma-packet         :inline)
   (mscalf-ret-tmpl                  dma-packet         :inline)
   (adgif-tmpl                       dma-gif-packet     :inline)
   (billboard-tmpl                   dma-gif-packet     :inline)
   (billboard-const                  vector             :inline)
   (shrub-near-packets               shrub-near-packet  6 :inline)
   (dma-ref                          dma-packet         :inline)
   (dma-end                          dma-packet         :inline)
   (wind-const                       vector             :inline)
   (constants                        vector             :inline)
   (color-constant                   vector4w           :inline)
   (hmge-d                           vector             :inline)
   (hvdf-offset                      vector             :inline)
   (wind-force                       vector             :inline)
   (color                            vector             :inline)
   (bb-color                         vector             :inline)
   (min-dist                         vector             :inline)
   (temp-vec                         vector             :inline)
   (guard-plane                      plane              4 :inline)
   (plane                            plane              4 :inline)
   (last                             uint32             4)
   (next                             uint32             4)
   (count                            uint16             4)
   (mod-count                        uint16             4)
   (wind-vectors                     uint32)
   (instance-ptr                     uint32)
   (chain-ptr                        uint32)
   (chain-ptr-next                   uint32)
   (stack-ptr                        uint32)
   (bucket-ptr                       uint32)
   (src-ptr                          uint32)
   (to-spr                           uint32)
   (from-spr                         uint32)
   (shrub-count                      uint32)
   (pad                              uint32)
   (node                             uint32             6)
   (length                           uint32             6)
   (prototypes                       uint32)
   (pad2                             uint32)
   (start-bank                       uint8              20)
   (buffer-index                     uint32)
   (current-spr                      uint32)
   (current-mem                      uint32)
   (current-shrub-near-packet        uint32)
   (current-shrub-near-trans-packet  uint32)
   (pad3                             uint32)
   (dma-buffer                       basic)
   (near-last                        uint32)
   (near-next                        uint32)
   (near-count                       uint32)
   (near-trans-last                  uint32)
   (near-trans-next                  uint32)
   (near-trans-count                 uint32)
   (last-shrubs                      uint32)
   (chains                           uint32)
   (flags                            uint32)
   (node-count                       uint32)
   (inst-count                       uint32)
   (wait-from-spr                    uint32)
   (wait-to-spr                      uint32)
   (texture-dists                    uint32)
   )
  )

;; definition for method 3 of type instance-shrub-work
(defmethod inspect ((this instance-shrub-work))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this 'instance-shrub-work)
  (format #t "~1Tdummy[3] @ #x~X~%" (-> this dummy))
  (format #t "~1Tchaina[8] @ #x~X~%" (-> this chaina))
  (format #t "~1Tchainb[8] @ #x~X~%" (-> this chainb))
  (format #t "~1Tcolors[1024] @ #x~X~%" (-> this colors))
  (format #t "~1Tmatrix-tmpl[20] @ #x~X~%" (-> this matrix-tmpl))
  (format #t "~1Tcount-tmpl[20] @ #x~X~%" (-> this count-tmpl))
  (format #t "~1Tmscalf-tmpl: #<dma-packet @ #x~X>~%" (-> this mscalf-tmpl))
  (format #t "~1Tmscalf-ret-tmpl: #<dma-packet @ #x~X>~%" (-> this mscalf-ret-tmpl))
  (format #t "~1Tadgif-tmpl: #<dma-gif-packet @ #x~X>~%" (-> this adgif-tmpl))
  (format #t "~1Tbillboard-tmpl: #<dma-gif-packet @ #x~X>~%" (-> this billboard-tmpl))
  (format #t "~1Tbillboard-const: #<vector @ #x~X>~%" (-> this billboard-const))
  (format #t "~1Tshrub-near-packets[6] @ #x~X~%" (-> this shrub-near-packets))
  (format #t "~1Tdma-ref: #<dma-packet @ #x~X>~%" (-> this dma-ref))
  (format #t "~1Tdma-end: #<dma-packet @ #x~X>~%" (-> this dma-end))
  (format #t "~1Twind-const: #<vector @ #x~X>~%" (-> this wind-const))
  (format #t "~1Tconstants: #<vector @ #x~X>~%" (-> this constants))
  (format #t "~1Tcolor-constant: #<vector4w @ #x~X>~%" (-> this color-constant))
  (format #t "~1Thmge-d: #<vector @ #x~X>~%" (-> this hmge-d))
  (format #t "~1Thvdf-offset: #<vector @ #x~X>~%" (-> this hvdf-offset))
  (format #t "~1Twind-force: #<vector @ #x~X>~%" (-> this wind-force))
  (format #t "~1Tcolor: #<vector @ #x~X>~%" (-> this color))
  (format #t "~1Tbb-color: #<vector @ #x~X>~%" (-> this bb-color))
  (format #t "~1Tmin-dist: #<vector @ #x~X>~%" (-> this min-dist))
  (format #t "~1Ttemp-vec: #<vector @ #x~X>~%" (-> this temp-vec))
  (format #t "~1Tguard-plane[4] @ #x~X~%" (-> this guard-plane))
  (format #t "~1Tplane[4] @ #x~X~%" (-> this plane))
  (format #t "~1Tlast[4] @ #x~X~%" (-> this last))
  (format #t "~1Tnext[4] @ #x~X~%" (-> this next))
  (format #t "~1Tcount[4] @ #x~X~%" (-> this count))
  (format #t "~1Tmod-count[4] @ #x~X~%" (-> this mod-count))
  (format #t "~1Twind-vectors: #x~X~%" (-> this wind-vectors))
  (format #t "~1Tinstance-ptr: ~D~%" (-> this instance-ptr))
  (format #t "~1Tchain-ptr: ~D~%" (-> this chain-ptr))
  (format #t "~1Tchain-ptr-next: ~D~%" (-> this chain-ptr-next))
  (format #t "~1Tstack-ptr: ~D~%" (-> this stack-ptr))
  (format #t "~1Tbucket-ptr: ~D~%" (-> this bucket-ptr))
  (format #t "~1Tsrc-ptr: ~D~%" (-> this src-ptr))
  (format #t "~1Tto-spr: ~D~%" (-> this to-spr))
  (format #t "~1Tfrom-spr: ~D~%" (-> this from-spr))
  (format #t "~1Tshrub-count: ~D~%" (-> this shrub-count))
  (format #t "~1Tstack-ptr: ~D~%" (-> this stack-ptr))
  (format #t "~1Tnode[6] @ #x~X~%" (-> this node))
  (format #t "~1Tlength[6] @ #x~X~%" (-> this length))
  (format #t "~1Tprototypes: ~D~%" (-> this prototypes))
  (format #t "~1Tbucket-ptr: ~D~%" (-> this bucket-ptr))
  (format #t "~1Tstart-bank[20] @ #x~X~%" (-> this start-bank))
  (format #t "~1Tbuffer-index: ~D~%" (-> this buffer-index))
  (format #t "~1Tcurrent-spr: ~D~%" (-> this current-spr))
  (format #t "~1Tcurrent-mem: ~D~%" (-> this current-mem))
  (format #t "~1Tcurrent-shrub-near-packet: ~D~%" (-> this current-shrub-near-packet))
  (format #t "~1Tcurrent-shrub-near-trans-packet: ~D~%" (-> this current-shrub-near-trans-packet))
  (format #t "~1Tto-spr: ~D~%" (-> this to-spr))
  (format #t "~1Tdma-buffer: ~A~%" (-> this dma-buffer))
  (format #t "~1Tnear-last: ~D~%" (-> this near-last))
  (format #t "~1Tnear-next: ~D~%" (-> this near-next))
  (format #t "~1Tnear-count: ~D~%" (-> this near-count))
  (format #t "~1Tnear-trans-last: ~D~%" (-> this near-trans-last))
  (format #t "~1Tnear-trans-next: ~D~%" (-> this near-trans-next))
  (format #t "~1Tnear-trans-count: ~D~%" (-> this near-trans-count))
  (format #t "~1Tlast-shrubs: ~D~%" (-> this last-shrubs))
  (format #t "~1Tchains: ~D~%" (-> this chains))
  (format #t "~1Tflags: ~D~%" (-> this flags))
  (format #t "~1Tnode-count: ~D~%" (-> this node-count))
  (format #t "~1Tinst-count: ~D~%" (-> this inst-count))
  (format #t "~1Twait-from-spr: ~D~%" (-> this wait-from-spr))
  (format #t "~1Twait-to-spr: ~D~%" (-> this wait-to-spr))
  (format #t "~1Ttexture-dists: #x~X~%" (-> this texture-dists))
  (label cfg-4)
  this
  )

;; definition of type instance-shrub-dma
(deftype instance-shrub-dma (structure)
  ((instancea  uint128  325)
   (instanceb  uint128  325)
   (outa       uint128  128)
   (outb       uint128  128)
   )
  )

;; definition for method 3 of type instance-shrub-dma
(defmethod inspect ((this instance-shrub-dma))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this 'instance-shrub-dma)
  (format #t "~1Tinstancea[325] @ #x~X~%" (-> this instancea))
  (format #t "~1Tinstanceb[325] @ #x~X~%" (-> this instanceb))
  (format #t "~1Touta[128] @ #x~X~%" (-> this outa))
  (format #t "~1Toutb[128] @ #x~X~%" (-> this outb))
  (label cfg-4)
  this
  )

;; failed to figure out what this is:
0
