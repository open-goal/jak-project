;;-*-Lisp-*-
(in-package goal)

;; definition of type vis-gif-tag
(deftype vis-gif-tag (structure)
  "Unused."
  ((fog0   uint32)
   (strip  uint32)
   (regs   uint32)
   (fan    uint32)
   )
  )

;; definition for method 3 of type vis-gif-tag
(defmethod inspect ((this vis-gif-tag))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this 'vis-gif-tag)
  (format #t "~1Tfog0: ~D~%" (-> this fog0))
  (format #t "~1Tstrip: ~D~%" (-> this strip))
  (format #t "~1Tregs: ~D~%" (-> this regs))
  (format #t "~1Tfan: ~D~%" (-> this fan))
  (label cfg-4)
  this
  )

;; definition of type cull-info
(deftype cull-info (structure)
  "Also seems unused."
  ((x-fact       float)
   (y-fact       float)
   (z-fact       float)
   (cam-radius   float)
   (cam-x        float)
   (cam-y        float)
   (xz-dir-ax    float)
   (xz-dir-az    float)
   (xz-dir-bx    float)
   (xz-dir-bz    float)
   (xz-cross-ab  float)
   (yz-dir-ay    float)
   (yz-dir-az    float)
   (yz-dir-by    float)
   (yz-dir-bz    float)
   (yz-cross-ab  float)
   )
  :allow-misaligned
  )

;; definition for method 3 of type cull-info
(defmethod inspect ((this cull-info))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this 'cull-info)
  (format #t "~1Tx-fact: ~f~%" (-> this x-fact))
  (format #t "~1Ty-fact: ~f~%" (-> this y-fact))
  (format #t "~1Tz-fact: ~f~%" (-> this z-fact))
  (format #t "~1Tcam-radius: ~f~%" (-> this cam-radius))
  (format #t "~1Tcam-x: ~f~%" (-> this cam-x))
  (format #t "~1Tcam-y: ~f~%" (-> this cam-y))
  (format #t "~1Txz-dir-ax: ~f~%" (-> this xz-dir-ax))
  (format #t "~1Txz-dir-az: ~f~%" (-> this xz-dir-az))
  (format #t "~1Txz-dir-bx: ~f~%" (-> this xz-dir-bx))
  (format #t "~1Txz-dir-bz: ~f~%" (-> this xz-dir-bz))
  (format #t "~1Txz-cross-ab: ~f~%" (-> this xz-cross-ab))
  (format #t "~1Tyz-dir-ay: ~f~%" (-> this yz-dir-ay))
  (format #t "~1Tyz-dir-az: ~f~%" (-> this yz-dir-az))
  (format #t "~1Tyz-dir-by: ~f~%" (-> this yz-dir-by))
  (format #t "~1Tyz-dir-bz: ~f~%" (-> this yz-dir-bz))
  (format #t "~1Tyz-cross-ab: ~f~%" (-> this yz-cross-ab))
  (label cfg-4)
  this
  )

;; definition of type math-camera
(deftype math-camera (basic)
  ((d                           meters)
   (f                           meters)
   (fov                         degrees)
   (x-ratio                     float)
   (y-ratio                     float)
   (x-pix                       float)
   (x-clip                      float)
   (x-clip-ratio-in             float)
   (x-clip-ratio-over           float)
   (y-pix                       float)
   (y-clip                      float)
   (y-clip-ratio-in             float)
   (y-clip-ratio-over           float)
   (cull-info                   cull-info    :inline)
   (fog-start                   meters)
   (fog-end                     meters)
   (fog-max                     float)
   (fog-min                     float)
   (reset                       int32)
   (smooth-step                 float)
   (smooth-t                    float)
   (perspective                 matrix       :inline)
   (isometric                   matrix       :inline)
   (sprite-2d                   matrix       :inline)
   (sprite-2d-hvdf              vector       :inline)
   (camera-rot                  matrix       :inline)
   (inv-camera-rot              matrix       :inline)
   (inv-camera-rot-smooth       matrix       :inline)
   (inv-camera-rot-smooth-from  quaternion   :inline)
   (camera-temp                 matrix       :inline)
   (prev-camera-temp            matrix       :inline)
   (prev-inv-camera-rot         matrix       :inline)
   (prev-trans                  vector       :inline)
   (hmge-scale                  vector       :inline)
   (inv-hmge-scale              vector       :inline)
   (hvdf-off                    vector       :inline)
   (guard                       vector       :inline)
   (vis-gifs                    vis-gif-tag  4 :inline)
   (giftex                      uint128      :overlay-at (-> vis-gifs 0 fog0))
   (gifgr                       uint128      :offset 864)
   (giftex-trans                uint128      :offset 880)
   (gifgr-trans                 uint128      :offset 896)
   (pfog0                       float)
   (pfog1                       float)
   (trans                       vector       :inline)
   (plane                       plane        4 :inline)
   (guard-plane                 plane        4 :inline)
   (shrub-mat                   matrix       :inline)
   (quat-other                  quaternion   :inline)
   (trans-other                 vector       :inline)
   (shrub-mat-other             matrix       :inline)
   (camera-temp-other           matrix       :inline)
   (camera-rot-other            matrix       :inline)
   (inv-camera-rot-other        matrix       :inline)
   (plane-other                 plane        4 :inline)
   (guard-plane-other           plane        4 :inline)
   (mirror-trans                vector       :inline)
   (mirror-normal               vector       :inline)
   (fov-correction-factor       float)
   )
  (:methods
    (new (symbol type) _type_)
    )
  )

;; definition for method 3 of type math-camera
;; INFO: Used lq/sq
(defmethod inspect ((this math-camera))
  (when (not this)
    (set! this this)
    (goto cfg-4)
    )
  (format #t "[~8x] ~A~%" this (-> this type))
  (format #t "~1Td: (meters ~m)~%" (-> this d))
  (format #t "~1Tf: (meters ~m)~%" (-> this f))
  (format #t "~1Tfov: (deg ~r)~%" (-> this fov))
  (format #t "~1Tx-ratio: ~f~%" (-> this x-ratio))
  (format #t "~1Ty-ratio: ~f~%" (-> this y-ratio))
  (format #t "~1Tx-pix: ~f~%" (-> this x-pix))
  (format #t "~1Tx-clip: ~f~%" (-> this x-clip))
  (format #t "~1Tx-clip-ratio-in: ~f~%" (-> this x-clip-ratio-in))
  (format #t "~1Tx-clip-ratio-over: ~f~%" (-> this x-clip-ratio-over))
  (format #t "~1Ty-pix: ~f~%" (-> this y-pix))
  (format #t "~1Ty-clip: ~f~%" (-> this y-clip))
  (format #t "~1Ty-clip-ratio-in: ~f~%" (-> this y-clip-ratio-in))
  (format #t "~1Ty-clip-ratio-over: ~f~%" (-> this y-clip-ratio-over))
  (format #t "~1Tcull-info: #<cull-info @ #x~X>~%" (-> this cull-info))
  (format #t "~1Tfog-start: (meters ~m)~%" (-> this fog-start))
  (format #t "~1Tfog-end: (meters ~m)~%" (-> this fog-end))
  (format #t "~1Tfog-max: ~f~%" (-> this fog-max))
  (format #t "~1Tfog-min: ~f~%" (-> this fog-min))
  (format #t "~1Treset: ~D~%" (-> this reset))
  (format #t "~1Tsmooth-step: ~f~%" (-> this smooth-step))
  (format #t "~1Tsmooth-t: ~f~%" (-> this smooth-t))
  (format #t "~1Tperspective: #<matrix @ #x~X>~%" (-> this perspective))
  (format #t "~1Tisometric: #<matrix @ #x~X>~%" (-> this isometric))
  (format #t "~1Tsprite-2d: #<matrix @ #x~X>~%" (-> this sprite-2d))
  (format #t "~1Tsprite-2d-hvdf: #<vector @ #x~X>~%" (-> this sprite-2d-hvdf))
  (format #t "~1Tcamera-rot: #<matrix @ #x~X>~%" (-> this camera-rot))
  (format #t "~1Tinv-camera-rot: #<matrix @ #x~X>~%" (-> this inv-camera-rot))
  (format #t "~1Tinv-camera-rot-smooth: #<matrix @ #x~X>~%" (-> this inv-camera-rot-smooth))
  (format #t "~1Tinv-camera-rot-smooth-from: #<quaternion @ #x~X>~%" (-> this inv-camera-rot-smooth-from))
  (format #t "~1Tcamera-temp: #<matrix @ #x~X>~%" (-> this camera-temp))
  (format #t "~1Tprev-camera-temp: #<matrix @ #x~X>~%" (-> this prev-camera-temp))
  (format #t "~1Tprev-inv-camera-rot: #<matrix @ #x~X>~%" (-> this prev-inv-camera-rot))
  (format #t "~1Tprev-trans: ~`vector`P~%" (-> this prev-trans))
  (format #t "~1Thmge-scale: #<vector @ #x~X>~%" (-> this hmge-scale))
  (format #t "~1Tinv-hmge-scale: #<vector @ #x~X>~%" (-> this inv-hmge-scale))
  (format #t "~1Thvdf-off: #<vector @ #x~X>~%" (-> this hvdf-off))
  (format #t "~1Tguard: #<vector @ #x~X>~%" (-> this guard))
  (format #t "~1Tvis-gifs[4] @ #x~X~%" (-> this vis-gifs))
  (format #t "~1Tgiftex: ~D~%" (-> this giftex))
  (format #t "~1Tgifgr: ~D~%" (-> this gifgr))
  (format #t "~1Tgiftex-trans: ~D~%" (-> this giftex-trans))
  (format #t "~1Tgifgr-trans: ~D~%" (-> this gifgr-trans))
  (format #t "~1Tpfog0: ~f~%" (-> this pfog0))
  (format #t "~1Tpfog1: ~f~%" (-> this pfog1))
  (format #t "~1Ttrans: ~`vector`P~%" (-> this trans))
  (format #t "~1Tplane[4] @ #x~X~%" (-> this plane))
  (format #t "~1Tguard-plane[4] @ #x~X~%" (-> this guard-plane))
  (format #t "~1Tshrub-mat: #<matrix @ #x~X>~%" (-> this shrub-mat))
  (format #t "~1Tquat-other: #<quaternion @ #x~X>~%" (-> this quat-other))
  (format #t "~1Ttrans-other: #<vector @ #x~X>~%" (-> this trans-other))
  (format #t "~1Tshrub-mat-other: #<matrix @ #x~X>~%" (-> this shrub-mat-other))
  (format #t "~1Tcamera-temp-other: #<matrix @ #x~X>~%" (-> this camera-temp-other))
  (format #t "~1Tcamera-rot-other: #<matrix @ #x~X>~%" (-> this camera-rot-other))
  (format #t "~1Tinv-camera-rot-other: #<matrix @ #x~X>~%" (-> this inv-camera-rot-other))
  (format #t "~1Tplane-other[4] @ #x~X~%" (-> this plane-other))
  (format #t "~1Tguard-plane-other[4] @ #x~X~%" (-> this guard-plane-other))
  (format #t "~1Tmirror-trans: #<vector @ #x~X>~%" (-> this mirror-trans))
  (format #t "~1Tmirror-normal: #<vector @ #x~X>~%" (-> this mirror-normal))
  (format #t "~1Tfov-correction-factor: ~f~%" (-> this fov-correction-factor))
  (label cfg-4)
  this
  )

;; failed to figure out what this is:
0
